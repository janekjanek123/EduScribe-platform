(()=>{var e={};e.id=7702,e.ids=[7702],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},12260:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(38256),t(55801),t(35866);var r=t(23191),a=t(88716),l=t(37922),i=t.n(l),n=t(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let o=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,38256)),"/Users/janjedrach/Cursor/eduscribe/src/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,55801)),"/Users/janjedrach/Cursor/eduscribe/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/janjedrach/Cursor/eduscribe/src/app/dashboard/page.tsx"],x="/dashboard/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},5955:(e,s,t)=>{Promise.resolve().then(t.bind(t,86457))},86457:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(10326),a=t(17577),l=t(35047),i=t(73189),n=t(83640);function d({className:e="",showLabel:s=!0}){let{usage:t,limits:l,isLoading:i,refreshUsage:d}=(0,n.m)(),[o,c]=(0,a.useState)(!1),x=async()=>{c(!0);try{await d()}catch(e){console.error("Failed to refresh usage:",e)}finally{c(!1)}};if(i)return r.jsx("div",{className:`animate-pulse ${e}`,children:r.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"})});let u=t.total_saved_notes/l.max_saved_notes*100,m=u>=90?{text:"text-red-600",bg:"bg-red-100",border:"border-red-200"}:u>=70?{text:"text-yellow-600",bg:"bg-yellow-100",border:"border-yellow-200"}:{text:"text-green-600",bg:"bg-green-100",border:"border-green-200"};return(0,r.jsxs)("div",{className:`inline-flex items-center space-x-2 ${e}`,children:[s&&r.jsx("span",{className:"text-sm text-gray-600",children:"Storage:"}),r.jsx("div",{className:`px-3 py-1 rounded-full border ${m.bg} ${m.border}`,children:(0,r.jsxs)("span",{className:`text-sm font-medium ${m.text}`,children:[t.total_saved_notes," / ",l.max_saved_notes," notes"]})}),r.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${u>=90?"bg-red-500":u>=70?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(u,100)}%`}})}),r.jsx("button",{onClick:x,disabled:o,className:`p-1 rounded-full transition-colors ${o?"text-gray-400 cursor-not-allowed":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,title:"Refresh storage count",children:r.jsx("svg",{className:`w-4 h-4 ${o?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})}function o({userId:e,refreshInterval:s=5e3,compact:t=!1}){let{user:l}=(0,i.$)(),[n,d]=(0,a.useState)(null),[o,c]=(0,a.useState)(!0),[x,u]=(0,a.useState)(null);if(e||l?.id,o)return r.jsx("div",{className:`${t?"p-3":"p-4"} bg-gray-50 rounded-lg border`,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Checking queue status..."})]})});if(x)return r.jsx("div",{className:`${t?"p-3":"p-4"} bg-red-50 border border-red-200 rounded-lg`,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-red-600",children:"⚠️"}),r.jsx("span",{className:"text-sm text-red-700",children:x})]})});if(!n||0===n.totalInQueue&&0===n.systemLoad.processing&&t)return null;let m=()=>{switch(n.statusColor){case"green":return"\uD83D\uDFE2";case"yellow":return"\uD83D\uDFE1";case"red":return"\uD83D\uDD34";default:return"⚪"}},h=()=>Math.min(n.systemLoad.loadPercentage,100);return t?(0,r.jsxs)("div",{className:"p-3 bg-white border rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{children:m()}),r.jsx("span",{className:"text-sm font-medium",children:n.userPosition?`Position #${n.userPosition}`:"Queue Status"})]}),n.totalInQueue>0&&(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[n.totalInQueue," in queue"]})]}),n.userPosition&&(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:["Est. wait: ",Math.ceil(n.estimatedWaitTime/60)," min"]})]}):(0,r.jsxs)("div",{className:"p-4 bg-white border rounded-lg shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Queue Status"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{children:m()}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[n.systemLoad.processing,"/",n.systemLoad.capacity," processing"]})]})]}),r.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:r.jsx("p",{className:"text-sm text-gray-700",children:n.message})}),n.userPosition&&r.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium text-blue-900",children:["Your Position: #",n.userPosition]}),(0,r.jsxs)("p",{className:"text-sm text-blue-700",children:["Estimated wait: ",Math.ceil(n.estimatedWaitTime/60)," minutes"]})]}),r.jsx("div",{className:"text-2xl",children:"⏳"})]})}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("span",{className:"text-sm font-medium text-gray-700",children:"System Load"}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(h()),"%"]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${"green"===n.statusColor?"bg-green-500":"yellow"===n.statusColor?"bg-yellow-500":"bg-red-500"}`,style:{width:`${h()}%`}})})]}),n.totalInQueue>0&&(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-center",children:[(0,r.jsxs)("div",{className:"p-2 bg-purple-50 rounded",children:[r.jsx("div",{className:"text-lg font-bold text-purple-600",children:n.priorityBreakdown.high}),r.jsx("div",{className:"text-xs text-purple-700",children:"Pro Users"})]}),(0,r.jsxs)("div",{className:"p-2 bg-blue-50 rounded",children:[r.jsx("div",{className:"text-lg font-bold text-blue-600",children:n.priorityBreakdown.medium}),r.jsx("div",{className:"text-xs text-blue-700",children:"Students"})]}),(0,r.jsxs)("div",{className:"p-2 bg-gray-50 rounded",children:[r.jsx("div",{className:"text-lg font-bold text-gray-600",children:n.priorityBreakdown.low}),r.jsx("div",{className:"text-xs text-gray-700",children:"Free Users"})]})]}),(0,r.jsxs)("div",{className:"mt-3 text-xs text-gray-400 text-center",children:["Last updated: ",new Date(n.timestamp).toLocaleTimeString()]})]})}function c(){let e=(0,l.useRouter)(),{user:s,supabase:t}=(0,i.$)(),{refreshUsage:c}=(0,n.m)(),[x,u]=(0,a.useState)([]),[m,h]=(0,a.useState)(!0),[g,p]=(0,a.useState)(""),[b,j]=(0,a.useState)("all"),[y,v]=(0,a.useState)(!1),[N,f]=(0,a.useState)({isOpen:!1,noteId:"",noteTitle:"",noteType:"text"}),w=async()=>{try{await t.auth.signOut(),v(!1),e.push("/")}catch(e){console.error("Error signing out:",e),v(!1)}},k=s=>{switch(s.type){case"video":case"video-upload":e.push(`/video-notes?id=${s.id}`);break;case"file":e.push(`/file-notes?id=${s.id}`);break;case"text":e.push(`/text-notes?id=${s.id}`)}},D=async()=>{if(N.noteId&&s)try{let{data:{session:e}}=await t.auth.getSession(),s=e?.access_token;if(!s)throw Error("No authentication token available");let r="";switch(N.noteType){case"video":r="/api/video-notes";break;case"video-upload":r="/api/upload-video";break;case"file":r="/api/file-notes";break;case"text":r="/api/text-notes";break;default:throw Error("Unknown note type")}console.log(`[Dashboard] Deleting ${N.noteType} note: ${N.noteId}`);let a=await fetch(`${r}?id=${N.noteId}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to delete note")}u(e=>e.filter(e=>e.id!==N.noteId)),f({isOpen:!1,noteId:"",noteTitle:"",noteType:"text"}),console.log(`[Dashboard] Successfully deleted note: ${N.noteId}`),console.log("[Dashboard] Refreshing saved notes count after deletion...");try{await c(),console.log("[Dashboard] Saved notes count refreshed after deletion")}catch(e){console.warn("[Dashboard] Failed to refresh saved notes count after deletion:",e)}}catch(e){console.error("[Dashboard] Error deleting note:",e),p(e.message||"Failed to delete note")}},C=e=>{f({isOpen:!0,noteId:e.id,noteTitle:e.title||"Untitled Note",noteType:e.type})};if(!s)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Please log in to view your dashboard"}),r.jsx("button",{onClick:()=>e.push("/"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Go to Login"})]})});let $="all"===b?x:"video"===b?x.filter(e=>"video"===e.type||"video-upload"===e.type):x.filter(e=>e.type===b);return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Notes Dashboard"}),r.jsx("p",{className:"text-gray-600 mt-1",children:"Manage all your generated notes in one place"}),r.jsx("div",{className:"mt-3",children:r.jsx(d,{})})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:()=>e.push("/generate/youtube"),className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700",children:"+ Video Notes"}),r.jsx("button",{onClick:()=>e.push("/generate/upload"),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700",children:"+ File Notes"}),r.jsx("button",{onClick:()=>e.push("/generate/text"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"+ Text Notes"})]})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6",children:r.jsx("div",{className:"border-b border-gray-200",children:r.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[{key:"all",label:"All Notes",count:x.length},{key:"video",label:"Video Notes",count:x.filter(e=>"video"===e.type).length},{key:"file",label:"File Notes",count:x.filter(e=>"file"===e.type).length},{key:"text",label:"Text Notes",count:x.filter(e=>"text"===e.type).length},{key:"video-upload",label:"Video Uploads",count:x.filter(e=>"video-upload"===e.type).length}].map(e=>(0,r.jsxs)("button",{onClick:()=>j(e.key),className:`py-4 px-1 border-b-2 font-medium text-sm ${b===e.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.label," (",e.count,")"]},e.key))})})}),m?r.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[1,2,3,4,5,6].map(e=>r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:r.jsx("div",{className:"animate-pulse",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded mb-2"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded mb-1"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded mb-1"}),r.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]})})},e))}):0===$.length?(0,r.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:[r.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDCDD"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No notes yet"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"all"!==b?"No notes match your search criteria.":"Start by creating your first note using one of the tools above."}),!b&&(0,r.jsxs)("div",{className:"flex justify-center gap-4",children:[r.jsx("button",{onClick:()=>e.push("/generate/youtube"),className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700",children:"+ Video Notes"}),r.jsx("button",{onClick:()=>e.push("/generate/upload"),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700",children:"+ File Notes"}),r.jsx("button",{onClick:()=>e.push("/generate/text"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"+ Text Notes"})]})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"mb-6",children:r.jsx(o,{compact:!0})}),r.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:$.map(e=>r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${"video"===e.type||"video-upload"===e.type?"bg-red-100":"file"===e.type?"bg-green-100":"bg-blue-100"}`,children:r.jsx("span",{className:"text-xl",children:"video"===e.type?"\uD83C\uDFA5":"video-upload"===e.type?"\uD83D\uDCF9":"file"===e.type?"\uD83D\uDCC1":"\uD83D\uDCDD"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2 line-clamp-2",children:e.title||"Untitled Note"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm line-clamp-3 mb-3",children:[e.content?.substring(0,150),"..."]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,r.jsxs)("span",{className:"capitalize",children:["video-upload"===e.type?"Video Upload":"video"===e.type?"Video":"file"===e.type?"File":"Text"," Notes"]}),r.jsx("span",{children:"•"}),r.jsx("span",{children:new Date(e.created_at).toLocaleDateString()}),e.slide_count&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("span",{children:"•"}),(0,r.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:["\uD83D\uDCCA ",e.slide_count," slides"]})]}),e.quiz&&e.quiz.length>0&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("span",{children:"•"}),(0,r.jsxs)("span",{className:"flex items-center gap-1 text-blue-600",children:["\uD83D\uDCDD ",e.quiz.length," quiz questions"]})]})]})]}),r.jsx("div",{className:"flex items-center gap-2 ml-4",children:r.jsx("button",{onClick:()=>C(e),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete note",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]}),r.jsx("div",{className:"mt-4",children:r.jsx("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View Full Notes →"})})]})]})},e.id))})]})]}),N.isOpen&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Note"})]}),(0,r.jsxs)("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete "',r.jsx("strong",{children:N.noteTitle}),'"? This action cannot be undone.']}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>{f({isOpen:!1,noteId:"",noteTitle:"",noteType:"text"})},className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),r.jsx("button",{onClick:D,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors",children:"Delete Note"})]})]})}),y&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Confirm Logout"})]}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to log out? You'll need to sign in again to access your notes and quizzes."}),(0,r.jsxs)("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>{v(!1)},className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),r.jsx("button",{onClick:w,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors",children:"Logout"})]})]})})]})}},38256:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/janjedrach/Cursor/eduscribe/src/app/dashboard/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[9276,8486,8796],()=>t(12260));module.exports=r})();