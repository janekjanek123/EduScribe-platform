exports.id=1947,exports.ids=[1947],exports.modules={69359:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let i=r(76162),s=a(r(65074)),o=r(10499);class n extends i.Writable{constructor(e){let t,r,a,i,n,l,d,u,c;super(),this._parser=s.default.createStream(!1,{lowercase:!0}),this._parser.on("error",this.destroy.bind(this));let p=0,m=0,h=[],b=!1,y=!1,f=t=>{let r={RepresentationID:e,Number:m,Time:p};return t.replace(/\$(\w+)\$/g,(e,t)=>`${r[t]}`)};this._parser.on("opentag",s=>{switch(s.name){case"mpd":p=s.attributes.availabilitystarttime?new Date(s.attributes.availabilitystarttime).getTime():0,d="dynamic"!==s.attributes.type;break;case"period":m=0,a=1e3,n=0,i=0,l=[],u=0,c=o.durationStr(s.attributes.start)||0;break;case"segmentlist":m=parseInt(s.attributes.startnumber)||m,a=parseInt(s.attributes.timescale)||a,n=parseInt(s.attributes.duration)||n,i=parseInt(s.attributes.presentationtimeoffset)||i;break;case"segmenttemplate":r=s.attributes,m=parseInt(s.attributes.startnumber)||m,a=parseInt(s.attributes.timescale)||a;break;case"segmenttimeline":case"baseurl":t=s.name;break;case"s":h.push({duration:parseInt(s.attributes.d),repeat:parseInt(s.attributes.r),time:parseInt(s.attributes.t)});break;case"adaptationset":case"representation":u++,e||(e=s.attributes.id),(b=s.attributes.id===`${e}`)&&(c&&(p+=c),i&&(p-=i/a*1e3),this.emit("starttime",p));break;case"initialization":b&&this.emit("item",{url:l.filter(e=>!!e).join("")+s.attributes.sourceurl,seq:m,init:!0,duration:0});break;case"segmenturl":if(b){y=!0;let e=h.shift(),t=((null==e?void 0:e.duration)||n)/a*1e3;this.emit("item",{url:l.filter(e=>!!e).join("")+s.attributes.media,seq:m++,duration:t}),p+=t}}});let g=()=>{d&&this.emit("endlist"),b?this.emit("end"):this.destroy(Error(`Representation '${e}' not found`))};this._parser.on("closetag",e=>{switch(e){case"adaptationset":case"representation":if(u--,r&&h.length)for(let{duration:e,repeat:t,time:i}of(y=!0,r.initialization&&this.emit("item",{url:l.filter(e=>!!e).join("")+f(r.initialization),seq:m,init:!0,duration:0}),h)){e=e/a*1e3,t=t||1,p=i||p;for(let a=0;a<t;a++)this.emit("item",{url:l.filter(e=>!!e).join("")+f(r.media),seq:m++,duration:e}),p+=e}y&&(this.emit("endearly"),g(),this._parser.removeAllListeners(),this.removeAllListeners("finish"))}}),this._parser.on("text",e=>{"baseurl"===t&&(l[u]=e,t=null)}),this.on("finish",g)}_write(e,t,r){this._parser.write(e),r()}}t.default=n},52231:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};let i=r(76162),s=a(r(3507)),o=a(r(33306)),n=a(r(69359)),l=r(90417),d=r(10499),u={m3u8:o.default,"dash-mpd":n.default},c=(e,t={})=>{let r,a,o,n,c,p,m;let h=new i.PassThrough({highWaterMark:t.highWaterMark}),b=t.chunkReadahead||3,y=t.liveBuffer||2e4,f=t.requestOptions,g=u[t.parser||(/\.mpd$/.test(e)?"dash-mpd":"m3u8")];if(!g)throw TypeError(`parser '${t.parser}' not supported`);let w=0;void 0!==t.begin&&(w="string"==typeof t.begin?d.humanStr(t.begin):Math.max(t.begin-y,0));let v=e=>{for(let t of["abort","request","response","redirect","retry","reconnect"])e.on(t,h.emit.bind(h,t))},R=new l.Queue((e,t)=>{r=e;let a=0;e.on("data",e=>a+=e.length),e.pipe(h,{end:!1}),e.on("end",()=>t(null,a))},{concurrency:1}),_=0,T=0,L=new l.Queue((t,r)=>{let a=Object.assign({},f);t.range&&(a.headers=Object.assign({},a.headers,{Range:`bytes=${t.range.start}-${t.range.end}`}));let i=s.default(new URL(t.url,e).toString(),a);i.on("error",r),v(i),R.push(i,(e,a)=>{T+=+a,h.emit("progress",{num:++_,size:a,duration:t.duration,url:t.url},L.total,T),r(null)})},{concurrency:b}),I=e=>{h.emit("error",e),h.end()},x=!0,E=!1,B=!1,q=e=>{if(r=null,e)I(e);else if(x||E||B||!(L.tasks.length+L.active<=a))(E||B)&&!L.tasks.length&&!L.active&&h.end();else{let e=Math.max(0,o-(Date.now()-c));x=!0,n=setTimeout(P,e)}},D=0,P=()=>{c=Date.now(),(p=s.default(e,f)).on("error",I),v(p);let r=p.pipe(new g(t.id));r.on("starttime",e=>{!D&&(D=e,"string"==typeof t.begin&&w>=0&&(w+=D))}),r.on("endlist",()=>{B=!0}),r.on("endearly",p.unpipe.bind(p,r));let i=[],n=e=>{if(!e.init){if(e.seq<=m)return;m=e.seq}w=e.time,L.push(e,q),i.push(e)},l=[],d=0;r.on("item",e=>{let t=Object.assign({time:D},e);if(w<=t.time)n(t);else for(l.push(t),d+=t.duration;l.length>1&&d-l[0].duration>y;){let e=l.shift();d-=e.duration}D+=t.duration}),r.on("end",()=>{p=null,!i.length&&l.length&&l.forEach(e=>{n(e)}),a=Math.max(1,Math.ceil(.01*i.length)),o=i.reduce((e,t)=>t.duration+e,0),x=!1,q(null)})};return P(),h.end=()=>(E=!0,R.die(),L.die(),clearTimeout(n),null==p||p.destroy(),null==r||r.destroy(),i.PassThrough.prototype.end.call(h,null),h),h};c.parseTimestamp=d.humanStr,e.exports=c},33306:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(76162);class i extends a.Writable{constructor(){super(),this._lastLine="",this._seq=0,this._nextItemDuration=null,this._nextItemRange=null,this._lastItemRangeEnd=0,this.on("finish",()=>{this._parseLine(this._lastLine),this.emit("end")})}_parseAttrList(e){let t,r={},a=/([A-Z0-9-]+)=(?:"([^"]*?)"|([^,]*?))/g;for(;null!==(t=a.exec(e));)r[t[1]]=t[2]||t[3];return r}_parseRange(e){if(!e)return null;let t=e.split("@"),r=t[1]?parseInt(t[1]):this._lastItemRangeEnd+1,a=r+parseInt(t[0])-1,i={start:r,end:a};return this._lastItemRangeEnd=i.end,i}_parseLine(e){let t=e.match(/^#(EXT[A-Z0-9-]+)(?::(.*))?/);if(t){let e=t[1],r=t[2]||"";switch(e){case"EXT-X-PROGRAM-DATE-TIME":this.emit("starttime",new Date(r).getTime());break;case"EXT-X-MEDIA-SEQUENCE":this._seq=parseInt(r);break;case"EXT-X-MAP":{let e=this._parseAttrList(r);if(!e.URI){this.destroy(Error("`EXT-X-MAP` found without required attribute `URI`"));return}this.emit("item",{url:e.URI,seq:this._seq,init:!0,duration:0,range:this._parseRange(e.BYTERANGE)});break}case"EXT-X-BYTERANGE":this._nextItemRange=this._parseRange(r);break;case"EXTINF":this._nextItemDuration=Math.round(1e3*parseFloat(r.split(",")[0]));break;case"EXT-X-ENDLIST":this.emit("endlist")}}else!/^#/.test(e)&&e.trim()&&(this.emit("item",{url:e.trim(),seq:this._seq++,duration:this._nextItemDuration,range:this._nextItemRange}),this._nextItemRange=null)}_write(e,t,r){let a=e.toString("utf8").split("\n");this._lastLine&&(a[0]=this._lastLine+a[0]),a.forEach((e,t)=>{this.destroyed||(t<a.length-1?this._parseLine(e):this._lastLine=e)}),r()}}t.default=i},10499:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.durationStr=t.humanStr=void 0;let r=/^\d+$/,a=/^(?:(?:(\d+):)?(\d{1,2}):)?(\d{1,2})(?:\.(\d{3}))?$/,i={ms:1,s:1e3,m:6e4,h:36e5};t.humanStr=e=>{if("number"==typeof e)return e;if(r.test(e))return+e;let t=a.exec(e);if(t)return+(t[1]||0)*i.h+ +(t[2]||0)*i.m+ +t[3]*i.s+ +(t[4]||0);{let t,r=0,a=/(-?\d+)(ms|s|m|h)/g;for(;null!==(t=a.exec(e));)r+=+t[1]*i[t[2]];return r}},t.durationStr=e=>{let t,r=0,a=/(\d+(?:\.\d+)?)(S|M|H)/g;for(;null!==(t=a.exec(e));)r+=+t[1]*i[t[2].toLowerCase()];return r}},90417:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;class r{constructor(e,t={}){this._worker=e,this._concurrency=t.concurrency||1,this.tasks=[],this.total=0,this.active=0}push(e,t){this.tasks.push({item:e,callback:t}),this.total++,this._next()}_next(){if(this.active>=this._concurrency||!this.tasks.length)return;let{item:e,callback:t}=this.tasks.shift(),r=!1;this.active++,this._worker(e,(e,a)=>{r||(this.active--,r=!0,null==t||t(e,a),this._next())})}die(){this.tasks=[]}}t.Queue=r},3507:function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};let i=a(r(32615)),s=a(r(35240)),o=r(76162),n={"http:":i.default,"https:":s.default},l=new Set([301,302,303,307,308]),d=new Set([429,503]),u=["connect","continue","information","socket","timeout","upgrade"],c=["aborted"];function p(e,t={}){var r;let a,i,s,m,h;let b=Object.assign({},p.defaultOptions,t),y=new o.PassThrough({highWaterMark:b.highWaterMark});y.destroyed=y.aborted=!1;let f=0,g=0,w=0,v=!1,R=0,_,T=0;if(null===(r=b.headers)||void 0===r?void 0:r.Range){let e=/bytes=(\d+)-(\d+)?/.exec(`${b.headers.Range}`);e&&(R=parseInt(e[1],10),_=parseInt(e[2],10))}b.acceptEncoding&&(b.headers=Object.assign({"Accept-Encoding":Object.keys(b.acceptEncoding).join(", ")},b.headers));let L=()=>s&&T>0,I=()=>!v||T===h,x=e=>{s=null,g=0,m=setTimeout(D,Math.min(b.backoff.inc,b.backoff.max)),y.emit("reconnect",w,e)},E=e=>!!("HEAD"!==t.method&&!I()&&w++<b.maxReconnects)&&(x(e),!0),B=e=>!y.destroyed&&(L()?E(e.err):!!((!e.err||"ENOTFOUND"===e.err.message)&&g++<b.maxRetries)&&(m=setTimeout(D,e.retryAfter||Math.min(g*b.backoff.inc,b.backoff.max)),y.emit("retry",g,e.err),!0)),q=(e,t)=>{for(let r of t)e.on(r,y.emit.bind(y,r))},D=()=>{let t={},r;try{let a="string"==typeof e?new URL(e):e;t=Object.assign({},{host:a.host,hostname:a.hostname,path:a.pathname+a.search+a.hash,port:a.port,protocol:a.protocol}),a.username&&(t.auth=`${a.username}:${a.password}`),r=n[String(t.protocol)]}catch(e){}if(!r){y.emit("error",new p.MinigetError(`Invalid URL: ${e}`));return}if(Object.assign(t,b),v&&T>0){let e=T+R,r=_||"";t.headers=Object.assign({},t.headers,{Range:`bytes=${e}-${r}`})}if(b.transform){try{t=b.transform(t)}catch(e){y.emit("error",e);return}if((!t||t.protocol)&&!(r=n[String(null==t?void 0:t.protocol)])){y.emit("error",new p.MinigetError("Invalid URL object from `transform` function"));return}}let o=e=>{y.destroyed||y.readableEnded||(g(),B({err:e})?a.removeListener("close",m):y.emit("error",e))},m=()=>{g(),B({})},g=()=>{a.removeListener("close",m),null==i||i.removeListener("data",w),null==s||s.removeListener("end",L)},w=e=>{T+=e.length},L=()=>{g(),E()||y.end()};(a=r.request(t,t=>{if(!y.destroyed){if(l.has(t.statusCode)){if(f++>=b.maxRedirects)y.emit("error",new p.MinigetError("Too many redirects"));else{if(t.headers.location)e=t.headers.location;else{let e=new p.MinigetError("Redirect status code given with no location",t.statusCode);y.emit("error",e),g();return}setTimeout(D,1e3*parseInt(t.headers["retry-after"]||"0",10)),y.emit("redirect",e)}g();return}if(d.has(t.statusCode)){if(!B({retryAfter:parseInt(t.headers["retry-after"]||"0",10)})){let e=new p.MinigetError(`Status code: ${t.statusCode}`,t.statusCode);y.emit("error",e)}g();return}if(t.statusCode&&(t.statusCode<200||t.statusCode>=400)){let e=new p.MinigetError(`Status code: ${t.statusCode}`,t.statusCode);t.statusCode>=500?o(e):y.emit("error",e),g();return}if(s=t,b.acceptEncoding&&t.headers["content-encoding"])for(let e of t.headers["content-encoding"].split(", ").reverse()){let t=b.acceptEncoding[e];t&&(s=s.pipe(t())).on("error",o)}h||(h=parseInt(`${t.headers["content-length"]}`,10),v="bytes"===t.headers["accept-ranges"]&&h>0&&b.maxReconnects>0),t.on("data",w),s.on("end",L),s.pipe(y,{end:!v}),i=t,y.emit("response",t),t.on("error",o),q(t,c)}})).on("error",o),a.on("close",m),q(a,u),y.destroyed&&M(...P),y.emit("request",a),a.end()};y.abort=e=>{console.warn("`MinigetStream#abort()` has been deprecated in favor of `MinigetStream#destroy()`"),y.aborted=!0,y.emit("abort"),y.destroy(e)};let P=[],M=e=>{a.destroy(e),null==s||s.unpipe(y),null==s||s.destroy(),clearTimeout(m)};return y._destroy=(...e)=>{y.destroyed=!0,a?M(...e):P=e},y.text=()=>new Promise((e,t)=>{let r="";y.setEncoding("utf8"),y.on("data",e=>r+=e),y.on("end",()=>e(r)),y.on("error",t)}),process.nextTick(D),y}p.MinigetError=class extends Error{constructor(e,t){super(e),this.statusCode=t}},p.defaultOptions={maxRedirects:10,maxRetries:2,maxReconnects:0,backoff:{inc:100,max:1e4}},e.exports=p},8507:(e,t,r)=>{let{setTimeout:a}=r(95346);e.exports=class extends Map{constructor(e=1e3){super(),this.timeout=e}set(e,t){this.has(e)&&clearTimeout(super.get(e).tid),super.set(e,{tid:a(this.delete.bind(this,e),this.timeout).unref(),value:t})}get(e){let t=super.get(e);return t?t.value:null}getOrSet(e,t){if(this.has(e))return this.get(e);{let r=t();return this.set(e,r),(async()=>{try{await r}catch(t){this.delete(e)}})(),r}}delete(e){let t=super.get(e);t&&(clearTimeout(t.tid),super.delete(e))}clear(){for(let e of this.values())clearTimeout(e.tid);super.clear()}}},15623:(e,t,r)=>{let a=r(69871),i=r(30162),s=["mp4a","mp3","vorbis","aac","opus","flac"],o=["mp4v","avc1","Sorenson H.283","MPEG-4 Visual","VP8","VP9","H.264"],n=e=>e.bitrate||0,l=e=>o.findIndex(t=>e.codecs&&e.codecs.includes(t)),d=e=>e.audioBitrate||0,u=e=>s.findIndex(t=>e.codecs&&e.codecs.includes(t)),c=(e,t,r)=>{let a=0;for(let i of r)if(0!=(a=i(t)-i(e)))break;return a},p=(e,t)=>c(e,t,[e=>parseInt(e.qualityLabel),n,l]),m=(e,t)=>c(e,t,[d,u]);t.sortFormats=(e,t)=>c(e,t,[e=>+!!e.isHLS,e=>+!!e.isDashMPD,e=>+(e.contentLength>0),e=>+(e.hasVideo&&e.hasAudio),e=>+e.hasVideo,e=>parseInt(e.qualityLabel)||0,n,d,l,u]),t.chooseFormat=(e,r)=>{let a;if("object"==typeof r.format){if(!r.format.url)throw Error("Invalid format given, did you use `ytdl.getInfo()`?");return r.format}r.filter&&(e=t.filterFormats(e,r.filter)),e.some(e=>e.isHLS)&&(e=e.filter(e=>e.isHLS||!e.isLive));let i=r.quality||"highest";switch(i){case"highest":a=e[0];break;case"lowest":a=e[e.length-1];break;case"highestaudio":{(e=t.filterFormats(e,"audio")).sort(m);let r=e[0],i=(e=e.filter(e=>0===m(r,e))).map(e=>parseInt(e.qualityLabel)||0).sort((e,t)=>e-t)[0];a=e.find(e=>(parseInt(e.qualityLabel)||0)===i);break}case"lowestaudio":(e=t.filterFormats(e,"audio")).sort(m),a=e[e.length-1];break;case"highestvideo":{(e=t.filterFormats(e,"video")).sort(p);let r=e[0],i=(e=e.filter(e=>0===p(r,e))).map(e=>e.audioBitrate||0).sort((e,t)=>e-t)[0];a=e.find(e=>(e.audioBitrate||0)===i);break}case"lowestvideo":(e=t.filterFormats(e,"video")).sort(p),a=e[e.length-1];break;default:a=h(i,e)}if(!a)throw Error(`No such format found: ${i}`);return a};let h=(e,t)=>{let r=e=>t.find(t=>`${t.itag}`==`${e}`);return Array.isArray(e)?r(e.find(e=>r(e))):r(e)};t.filterFormats=(e,t)=>{let r;switch(t){case"videoandaudio":case"audioandvideo":r=e=>e.hasVideo&&e.hasAudio;break;case"video":r=e=>e.hasVideo;break;case"videoonly":r=e=>e.hasVideo&&!e.hasAudio;break;case"audio":r=e=>e.hasAudio;break;case"audioonly":r=e=>!e.hasVideo&&e.hasAudio;break;default:if("function"==typeof t)r=t;else throw TypeError(`Given filter (${t}) is not supported`)}return e.filter(e=>!!e.url&&r(e))},t.addFormatMeta=e=>((e=Object.assign({},i[e.itag],e)).hasVideo=!!e.qualityLabel,e.hasAudio=!!e.audioBitrate,e.container=e.mimeType?e.mimeType.split(";")[0].split("/")[1]:null,e.codecs=e.mimeType?a.between(e.mimeType,'codecs="','"'):null,e.videoCodec=e.hasVideo&&e.codecs?e.codecs.split(", ")[0]:null,e.audioCodec=e.hasAudio&&e.codecs?e.codecs.split(", ").slice(-1)[0]:null,e.isLive=/\bsource[/=]yt_live_broadcast\b/.test(e.url),e.isHLS=/\/manifest\/hls_(variant|playlist)\//.test(e.url),e.isDashMPD=/\/manifest\/dash\//.test(e.url),e)},30162:e=>{e.exports={5:{mimeType:'video/flv; codecs="Sorenson H.283, mp3"',qualityLabel:"240p",bitrate:25e4,audioBitrate:64},6:{mimeType:'video/flv; codecs="Sorenson H.263, mp3"',qualityLabel:"270p",bitrate:8e5,audioBitrate:64},13:{mimeType:'video/3gp; codecs="MPEG-4 Visual, aac"',qualityLabel:null,bitrate:5e5,audioBitrate:null},17:{mimeType:'video/3gp; codecs="MPEG-4 Visual, aac"',qualityLabel:"144p",bitrate:5e4,audioBitrate:24},18:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:96},22:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"720p",bitrate:2e6,audioBitrate:192},34:{mimeType:'video/flv; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:128},35:{mimeType:'video/flv; codecs="H.264, aac"',qualityLabel:"480p",bitrate:8e5,audioBitrate:128},36:{mimeType:'video/3gp; codecs="MPEG-4 Visual, aac"',qualityLabel:"240p",bitrate:175e3,audioBitrate:32},37:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"1080p",bitrate:3e6,audioBitrate:192},38:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"3072p",bitrate:35e5,audioBitrate:192},43:{mimeType:'video/webm; codecs="VP8, vorbis"',qualityLabel:"360p",bitrate:5e5,audioBitrate:128},44:{mimeType:'video/webm; codecs="VP8, vorbis"',qualityLabel:"480p",bitrate:1e6,audioBitrate:128},45:{mimeType:'video/webm; codecs="VP8, vorbis"',qualityLabel:"720p",bitrate:2e6,audioBitrate:192},46:{mimeType:'audio/webm; codecs="vp8, vorbis"',qualityLabel:"1080p",bitrate:null,audioBitrate:192},82:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:96},83:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"240p",bitrate:5e5,audioBitrate:96},84:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"720p",bitrate:2e6,audioBitrate:192},85:{mimeType:'video/mp4; codecs="H.264, aac"',qualityLabel:"1080p",bitrate:3e6,audioBitrate:192},91:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"144p",bitrate:1e5,audioBitrate:48},92:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"240p",bitrate:15e4,audioBitrate:48},93:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"360p",bitrate:5e5,audioBitrate:128},94:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"480p",bitrate:8e5,audioBitrate:128},95:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"720p",bitrate:15e5,audioBitrate:256},96:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"1080p",bitrate:25e5,audioBitrate:256},100:{mimeType:'audio/webm; codecs="VP8, vorbis"',qualityLabel:"360p",bitrate:null,audioBitrate:128},101:{mimeType:'audio/webm; codecs="VP8, vorbis"',qualityLabel:"360p",bitrate:null,audioBitrate:192},102:{mimeType:'audio/webm; codecs="VP8, vorbis"',qualityLabel:"720p",bitrate:null,audioBitrate:192},120:{mimeType:'video/flv; codecs="H.264, aac"',qualityLabel:"720p",bitrate:2e6,audioBitrate:128},127:{mimeType:'audio/ts; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:96},128:{mimeType:'audio/ts; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:96},132:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"240p",bitrate:15e4,audioBitrate:48},133:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"240p",bitrate:2e5,audioBitrate:null},134:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"360p",bitrate:3e5,audioBitrate:null},135:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"480p",bitrate:5e5,audioBitrate:null},136:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"720p",bitrate:1e6,audioBitrate:null},137:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"1080p",bitrate:25e5,audioBitrate:null},138:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"4320p",bitrate:135e5,audioBitrate:null},139:{mimeType:'audio/mp4; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:48},140:{mimeType:'audio/m4a; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:128},141:{mimeType:'audio/mp4; codecs="aac"',qualityLabel:null,bitrate:null,audioBitrate:256},151:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"720p",bitrate:5e4,audioBitrate:24},160:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"144p",bitrate:1e5,audioBitrate:null},171:{mimeType:'audio/webm; codecs="vorbis"',qualityLabel:null,bitrate:null,audioBitrate:128},172:{mimeType:'audio/webm; codecs="vorbis"',qualityLabel:null,bitrate:null,audioBitrate:192},242:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"240p",bitrate:1e5,audioBitrate:null},243:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"360p",bitrate:25e4,audioBitrate:null},244:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"480p",bitrate:5e5,audioBitrate:null},247:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"720p",bitrate:7e5,audioBitrate:null},248:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1080p",bitrate:15e5,audioBitrate:null},249:{mimeType:'audio/webm; codecs="opus"',qualityLabel:null,bitrate:null,audioBitrate:48},250:{mimeType:'audio/webm; codecs="opus"',qualityLabel:null,bitrate:null,audioBitrate:64},251:{mimeType:'audio/webm; codecs="opus"',qualityLabel:null,bitrate:null,audioBitrate:160},264:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"1440p",bitrate:4e6,audioBitrate:null},266:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"2160p",bitrate:125e5,audioBitrate:null},271:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1440p",bitrate:9e6,audioBitrate:null},272:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"4320p",bitrate:2e7,audioBitrate:null},278:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"144p 30fps",bitrate:8e4,audioBitrate:null},298:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"720p",bitrate:3e6,audioBitrate:null},299:{mimeType:'video/mp4; codecs="H.264"',qualityLabel:"1080p",bitrate:55e5,audioBitrate:null},300:{mimeType:'video/ts; codecs="H.264, aac"',qualityLabel:"720p",bitrate:1318e3,audioBitrate:48},302:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"720p HFR",bitrate:25e5,audioBitrate:null},303:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1080p HFR",bitrate:5e6,audioBitrate:null},308:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1440p HFR",bitrate:1e7,audioBitrate:null},313:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"2160p",bitrate:13e6,audioBitrate:null},315:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"2160p HFR",bitrate:2e7,audioBitrate:null},330:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"144p HDR, HFR",bitrate:8e4,audioBitrate:null},331:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"240p HDR, HFR",bitrate:1e5,audioBitrate:null},332:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"360p HDR, HFR",bitrate:25e4,audioBitrate:null},333:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"240p HDR, HFR",bitrate:5e5,audioBitrate:null},334:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"720p HDR, HFR",bitrate:1e6,audioBitrate:null},335:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1080p HDR, HFR",bitrate:15e5,audioBitrate:null},336:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"1440p HDR, HFR",bitrate:5e6,audioBitrate:null},337:{mimeType:'video/webm; codecs="VP9"',qualityLabel:"2160p HDR, HFR",bitrate:12e6,audioBitrate:null}}},71947:(e,t,r)=>{let a=r(76162).PassThrough,i=r(30133),s=r(69871),o=r(15623),n=r(46496),l=r(55389),d=r(3507),u=r(52231),{parseTimestamp:c}=r(52231),p=(e,t)=>{let r=m(t);return p.getInfo(e,t).then(e=>{b(r,e,t)},r.emit.bind(r,"error")),r};e.exports=p,p.getBasicInfo=i.getBasicInfo,p.getInfo=i.getInfo,p.chooseFormat=o.chooseFormat,p.filterFormats=o.filterFormats,p.validateID=n.validateID,p.validateURL=n.validateURL,p.getURLVideoID=n.getURLVideoID,p.getVideoID=n.getVideoID,p.cache={sig:l.cache,info:i.cache,watch:i.watchPageCache,cookie:i.cookieCache},p.version=r(3892).version;let m=e=>{let t=new a({highWaterMark:e&&e.highWaterMark||524288});return t._destroy=()=>{t.destroyed=!0},t},h=(e,t,r)=>{["abort","request","response","error","redirect","retry","reconnect"].forEach(r=>{e.prependListener(r,t.emit.bind(t,r))}),e.pipe(t,{end:r})},b=(e,t,r)=>{let a,i;r=r||{};let n=s.playError(t.player_response,["UNPLAYABLE","LIVE_STREAM_OFFLINE","LOGIN_REQUIRED"]);if(n){e.emit("error",n);return}if(!t.formats.length){e.emit("error",Error("This video is unavailable"));return}try{a=o.chooseFormat(t.formats,r)}catch(t){e.emit("error",t);return}if(e.emit("info",t,a),e.destroyed)return;let l,p=0,m=t=>{p+=t.length,e.emit("progress",t.length,p,l)};r.IPv6Block&&(r.requestOptions=Object.assign({},r.requestOptions,{family:6,localAddress:s.getRandomIPv6(r.IPv6Block)}));let b=r.dlChunkSize||10485760,y=!0;if(a.isHLS||a.isDashMPD)(i=u(a.url,{chunkReadahead:+t.live_chunk_readahead,begin:r.begin||a.isLive&&Date.now(),liveBuffer:r.liveBuffer,requestOptions:r.requestOptions,parser:a.isDashMPD?"dash-mpd":"m3u8",id:a.itag})).on("progress",(t,r)=>{e.emit("progress",t.size,t.num,r)}),h(i,e,y);else{let t=Object.assign({},r.requestOptions,{maxReconnects:6,maxRetries:3,backoff:{inc:500,max:1e4}});if(0===b||a.hasAudio&&a.hasVideo)r.begin&&(a.url+=`&begin=${c(r.begin)}`),r.range&&(r.range.start||r.range.end)&&(t.headers=Object.assign({},t.headers,{Range:`bytes=${r.range.start||"0"}-${r.range.end||""}`})),(i=d(a.url,t)).on("response",t=>{e.destroyed||(l=l||parseInt(t.headers["content-length"]))}),i.on("data",m),h(i,e,y);else{let s=r.range&&r.range.start||0,o=s+b,n=r.range&&r.range.end;l=r.range?(n?n+1:parseInt(a.contentLength))-s:parseInt(a.contentLength);let u=()=>{!n&&o>=l&&(o=0),n&&o>n&&(o=n),y=!o||o===n,t.headers=Object.assign({},t.headers,{Range:`bytes=${s}-${o||""}`}),(i=d(a.url,t)).on("data",m),i.on("end",()=>{!e.destroyed&&o&&o!==n&&(s=o+1,o+=b,u())}),h(i,e,y)};u()}}e._destroy=()=>{e.destroyed=!0,i.destroy(),i.end()}};p.downloadFromInfo=(e,t)=>{let r=m(t);if(!e.full)throw Error("Cannot use `ytdl.downloadFromInfo()` when called with info from `ytdl.getBasicInfo()`");return setImmediate(()=>{b(r,e,t)}),r}},78876:(e,t,r)=>{let a=r(69871),i=r(86624),{parseTimestamp:s}=r(52231),o="https://www.youtube.com/watch?v=",n={song:{name:"Music",url:"https://music.youtube.com/"}},l=e=>e?e.runs?e.runs[0].text:e.simpleText:null;t.getMedia=e=>{let t={},r=[];try{r=e.response.contents.twoColumnWatchNextResults.results.results.contents}catch(e){}let a=r.find(e=>e.videoSecondaryInfoRenderer);if(!a)return{};try{for(let e of(a.metadataRowContainer||a.videoSecondaryInfoRenderer.metadataRowContainer).metadataRowContainerRenderer.rows)if(e.metadataRowRenderer){let r=l(e.metadataRowRenderer.title).toLowerCase(),a=e.metadataRowRenderer.contents[0];t[r]=l(a);let i=a.runs;i&&i[0].navigationEndpoint&&(t[`${r}_url`]=new URL(i[0].navigationEndpoint.commandMetadata.webCommandMetadata.url,o).toString()),r in n&&(t.category=n[r].name,t.category_url=n[r].url)}else if(e.richMetadataRowRenderer){let r=e.richMetadataRowRenderer.contents;for(let{richMetadataRenderer:e}of r.filter(e=>"RICH_METADATA_RENDERER_STYLE_BOX_ART"===e.richMetadataRenderer.style)){t.year=l(e.subtitle);let r=l(e.callToAction).split(" ")[1];t[r]=l(e.title),t[`${r}_url`]=new URL(e.endpoint.commandMetadata.webCommandMetadata.url,o).toString(),t.thumbnails=e.thumbnail.thumbnails}for(let{richMetadataRenderer:e}of r.filter(e=>"RICH_METADATA_RENDERER_STYLE_TOPIC"===e.richMetadataRenderer.style))t.category=l(e.title),t.category_url=new URL(e.endpoint.commandMetadata.webCommandMetadata.url,o).toString()}}catch(e){}return t};let d=e=>!!(e&&e.find(e=>"Verified"===e.metadataBadgeRenderer.tooltip));t.getAuthor=e=>{let t,r=[],i,s=!1;try{let n=e.response.contents.twoColumnWatchNextResults.results.results.contents.find(e=>e.videoSecondaryInfoRenderer&&e.videoSecondaryInfoRenderer.owner&&e.videoSecondaryInfoRenderer.owner.videoOwnerRenderer).videoSecondaryInfoRenderer.owner.videoOwnerRenderer;t=n.navigationEndpoint.browseEndpoint.browseId,r=n.thumbnail.thumbnails.map(e=>(e.url=new URL(e.url,o).toString(),e)),i=a.parseAbbreviatedNumber(l(n.subscriberCountText)),s=d(n.badges)}catch(e){}try{let n=e.player_response.microformat&&e.player_response.microformat.playerMicroformatRenderer,l=n&&n.channelId||t||e.player_response.videoDetails.channelId,d={id:l,name:n?n.ownerChannelName:e.player_response.videoDetails.author,user:n?n.ownerProfileUrl.split("/").slice(-1)[0]:null,channel_url:`https://www.youtube.com/channel/${l}`,external_channel_url:n?`https://www.youtube.com/channel/${n.externalChannelId}`:"",user_url:n?new URL(n.ownerProfileUrl,o).toString():"",thumbnails:r,verified:s,subscriber_count:i};return r.length&&a.deprecate(d,"avatar",d.thumbnails[0].url,"author.avatar","author.thumbnails[0].url"),d}catch(e){return{}}};let u=(e,t)=>{if(e)try{let r=l(e.viewCountText),i=l(e.shortViewCountText),n=t.find(t=>t.id===e.videoId);/^\d/.test(i)||(i=n&&n.short_view_count_text||""),r=(/^\d/.test(r)?r:i).split(" ")[0];let u=e.shortBylineText.runs[0].navigationEndpoint.browseEndpoint,c=u.browseId,p=l(e.shortBylineText),m=(u.canonicalBaseUrl||"").split("/").slice(-1)[0],h={id:e.videoId,title:l(e.title),published:l(e.publishedTimeText),author:{id:c,name:p,user:m,channel_url:`https://www.youtube.com/channel/${c}`,user_url:`https://www.youtube.com/user/${m}`,thumbnails:e.channelThumbnail.thumbnails.map(e=>(e.url=new URL(e.url,o).toString(),e)),verified:d(e.ownerBadges),[Symbol.toPrimitive]:()=>(console.warn("`relatedVideo.author` will be removed in a near future release, use `relatedVideo.author.name` instead."),h.author.name)},short_view_count_text:i.split(" ")[0],view_count:r.replace(/,/g,""),length_seconds:e.lengthText?Math.floor(s(l(e.lengthText))/1e3):t&&`${t.length_seconds}`,thumbnails:e.thumbnail.thumbnails,richThumbnails:e.richThumbnail?e.richThumbnail.movingThumbnailRenderer.movingThumbnailDetails.thumbnails:[],isLive:!!(e.badges&&e.badges.find(e=>"LIVE NOW"===e.metadataBadgeRenderer.label))};return a.deprecate(h,"author_thumbnail",h.author.thumbnails[0].url,"relatedVideo.author_thumbnail","relatedVideo.author.thumbnails[0].url"),a.deprecate(h,"ucid",h.author.id,"relatedVideo.ucid","relatedVideo.author.id"),a.deprecate(h,"video_thumbnail",h.thumbnails[0].url,"relatedVideo.video_thumbnail","relatedVideo.thumbnails[0].url"),h}catch(e){}};t.getRelatedVideos=e=>{let t=[],r=[];try{t=e.response.webWatchNextResponseExtensionData.relatedVideoArgs.split(",").map(e=>i.parse(e))}catch(e){}try{r=e.response.contents.twoColumnWatchNextResults.secondaryResults.secondaryResults.results}catch(e){return[]}let a=[];for(let e of r||[]){let r=e.compactVideoRenderer;if(r){let e=u(r,t);e&&a.push(e)}else{let r=e.compactAutoplayRenderer||e.itemSectionRenderer;if(!r||!Array.isArray(r.contents))continue;for(let e of r.contents){let r=u(e.compactVideoRenderer,t);r&&a.push(r)}}}return a},t.getLikes=e=>{try{let t=e.response.contents.twoColumnWatchNextResults.results.results.contents.find(e=>e.videoPrimaryInfoRenderer).videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons.find(e=>e.toggleButtonRenderer&&"LIKE"===e.toggleButtonRenderer.defaultIcon.iconType);return parseInt(t.toggleButtonRenderer.defaultText.accessibility.accessibilityData.label.replace(/\D+/g,""))}catch(e){return null}},t.getDislikes=e=>{try{let t=e.response.contents.twoColumnWatchNextResults.results.results.contents.find(e=>e.videoPrimaryInfoRenderer).videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons.find(e=>e.toggleButtonRenderer&&"DISLIKE"===e.toggleButtonRenderer.defaultIcon.iconType);return parseInt(t.toggleButtonRenderer.defaultText.accessibility.accessibilityData.label.replace(/\D+/g,""))}catch(e){return null}},t.cleanVideoDetails=(e,t)=>(e.thumbnails=e.thumbnail.thumbnails,delete e.thumbnail,a.deprecate(e,"thumbnail",{thumbnails:e.thumbnails},"videoDetails.thumbnail.thumbnails","videoDetails.thumbnails"),e.description=e.shortDescription||l(e.description),delete e.shortDescription,a.deprecate(e,"shortDescription",e.description,"videoDetails.shortDescription","videoDetails.description"),e.lengthSeconds=t.player_response.microformat&&t.player_response.microformat.playerMicroformatRenderer.lengthSeconds||t.player_response.videoDetails.lengthSeconds,e),t.getStoryboards=e=>{let t=e.player_response.storyboards&&e.player_response.storyboards.playerStoryboardSpecRenderer&&e.player_response.storyboards.playerStoryboardSpecRenderer.spec&&e.player_response.storyboards.playerStoryboardSpecRenderer.spec.split("|");if(!t)return[];let r=new URL(t.shift());return t.map((e,t)=>{let[a,i,s,o,n,l,d,u]=e.split("#");r.searchParams.set("sigh",u);let c=Math.ceil((s=parseInt(s,10))/((o=parseInt(o,10))*(n=parseInt(n,10))));return{templateUrl:r.toString().replace("$L",t).replace("$N",d),thumbnailWidth:parseInt(a,10),thumbnailHeight:parseInt(i,10),thumbnailCount:s,interval:parseInt(l,10),columns:o,rows:n,storyboardCount:c}})},t.getChapters=e=>{let t=e.response&&e.response.playerOverlays&&e.response.playerOverlays.playerOverlayRenderer,r=t&&t.decoratedPlayerBarRenderer&&t.decoratedPlayerBarRenderer.decoratedPlayerBarRenderer&&t.decoratedPlayerBarRenderer.decoratedPlayerBarRenderer.playerBar,a=r&&r.multiMarkersPlayerBarRenderer&&r.multiMarkersPlayerBarRenderer.markersMap,i=Array.isArray(a)&&a.find(e=>e.value&&Array.isArray(e.value.chapters));return i?i.value.chapters.map(e=>({title:l(e.chapterRenderer.title),start_time:e.chapterRenderer.timeRangeStartMillis/1e3})):[]}},30133:(e,t,r)=>{let a=r(86624),i=r(65074),s=r(3507),o=r(69871),{setTimeout:n}=r(95346),l=r(15623),d=r(46496),u=r(78876),c=r(55389),p=r(8507),m="https://www.youtube.com/watch?v=";t.cache=new p,t.cookieCache=new p(864e5),t.watchPageCache=new p;let h="2.20210622.10.00";class b extends Error{}let y=["support.google.com/youtube/?p=age_restrictions","youtube.com/t/community_guidelines"];t.getBasicInfo=async(e,t)=>{t.IPv6Block&&(t.requestOptions=Object.assign({},t.requestOptions,{family:6,localAddress:o.getRandomIPv6(t.IPv6Block)}));let r=Object.assign({},s.defaultOptions,t.requestOptions);t.requestOptions=Object.assign({},t.requestOptions,{}),t.requestOptions.headers=Object.assign({},{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.101 Safari/537.36"},t.requestOptions.headers);let a=await I([e,t],e=>{let t=o.playError(e.player_response,["ERROR"],b),r=f(e.player_response);if(t||r)throw t||r;return e&&e.player_response&&(e.player_response.streamingData||g(e.player_response)||w(e.player_response))},r,[S,k,O]);Object.assign(a,{formats:A(a.player_response),related_videos:u.getRelatedVideos(a)});let i=u.getMedia(a),n={author:u.getAuthor(a),media:i,likes:u.getLikes(a),dislikes:u.getDislikes(a),age_restricted:!!(i&&y.some(e=>Object.values(i).some(t=>"string"==typeof t&&t.includes(e)))),video_url:m+e,storyboards:u.getStoryboards(a),chapters:u.getChapters(a)};return a.videoDetails=u.cleanVideoDetails(Object.assign({},a.player_response&&a.player_response.microformat&&a.player_response.microformat.playerMicroformatRenderer,a.player_response&&a.player_response.videoDetails,n),a),a};let f=e=>{let t=e&&e.playabilityStatus;return t&&"LOGIN_REQUIRED"===t.status&&t.messages&&t.messages.filter(e=>/This is a private video/.test(e)).length?new b(t.reason||t.messages&&t.messages[0]):null},g=e=>{let t=e.playabilityStatus;return t&&"UNPLAYABLE"===t.status&&t.errorScreen&&t.errorScreen.playerLegacyDesktopYpcOfferRenderer},w=e=>{let t=e.playabilityStatus;return t&&"LIVE_STREAM_OFFLINE"===t.status},v=(e,t)=>`${m+e}&hl=${t.lang||"en"}`,R=(e,r)=>{let a=v(e,r);return t.watchPageCache.getOrSet(a,()=>o.exposedMiniget(a,r).text())},_=(e,t)=>{let r=`${"https://www.youtube.com/embed/"+e}?hl=${t.lang||"en"}`;return o.exposedMiniget(r,t).text()},T=e=>{let t=/<script\s+src="([^"]+)"(?:\s+type="text\/javascript")?\s+name="player_ias\/base"\s*>|"jsUrl":"([^"]+)"/.exec(e);return t?t[1]||t[2]:null},L=(e,r,a,i)=>t.cookieCache.getOrSet(a,async()=>{let t=(await R(e,r)).match(/(["'])ID_TOKEN\1[:,]\s?"([^"]+)"/);if(!t&&i)throw new b("Cookie header used in request, but unable to find YouTube identity token");return t&&t[2]}),I=async(e,t,r,a)=>{let i;for(let s of a)try{let a=await E(s,e.concat([i]),r);if(a.player_response&&(a.player_response.videoDetails=x(i&&i.player_response&&i.player_response.videoDetails,a.player_response.videoDetails),a.player_response=x(i&&i.player_response,a.player_response)),i=x(i,a),t(i,!1))break}catch(e){if(e instanceof b||s===a[a.length-1])throw e}return i},x=(e,t)=>{if(!e||!t)return e||t;for(let[r,a]of Object.entries(t))null!=a&&(e[r]=a);return e},E=async(e,t,r)=>{let a=0,i;for(;a<=r.maxRetries;)try{i=await e(...t);break}catch(t){if(t instanceof b||t instanceof s.MinigetError&&t.statusCode<500||a>=r.maxRetries)throw t;let e=Math.min(++a*r.backoff.inc,r.backoff.max);await new Promise(t=>n(t,e))}return i},B=/^[)\]}'\s]+/,q=(e,t,r)=>{if(!r||"object"==typeof r)return r;try{return r=r.replace(B,""),JSON.parse(r)}catch(r){throw Error(`Error parsing ${t} in ${e}: ${r.message}`)}},D=(e,t,r,a,i,s)=>{let n=o.between(r,a,i);if(!n)throw Error(`Could not find ${t} in ${e}`);return q(e,t,o.cutAfterJS(`${s}${n}`))},P=(e,t)=>q(e,"player_response",t&&(t.args&&t.args.player_response||t.player_response||t.playerResponse||t.embedded_player_response)),M=(e,t)=>`${v(e,t)}&pbj=1`,k=async(e,r)=>{let a=Object.assign({headers:{}},r.requestOptions),i=a.headers.Cookie||a.headers.cookie;a.headers=Object.assign({"x-youtube-client-name":"1","x-youtube-client-version":h,"x-youtube-identity-token":t.cookieCache.get(i||"browser")||""},a.headers);let s=async(t,i)=>{a.headers["x-youtube-identity-token"]||(a.headers["x-youtube-identity-token"]=await L(e,r,t,i))};i&&await s(i,!0);let n=M(e,r),l=q("watch.json","body",await o.exposedMiniget(n,r,a).text());if("now"===l.reload&&await s("browser",!1),"now"===l.reload||!Array.isArray(l))throw Error("Unable to retrieve video metadata in watch.json");let d=l.reduce((e,t)=>Object.assign(t,e),{});return d.player_response=P("watch.json",d),d.html5player=d.player&&d.player.assets&&d.player.assets.js,d},S=async(e,t)=>{let r=await R(e,t),a={page:"watch"};try{h=o.between(r,'{"key":"cver","value":"','"}'),a.player_response=D("watch.html","player_response",r,/\bytInitialPlayerResponse\s*=\s*\{/i,"</script>","{")}catch(t){let e=D("watch.html","player_response",r,/\bytplayer\.config\s*=\s*{/,"</script>","{");a.player_response=P("watch.html",e)}return a.response=D("watch.html","response",r,/\bytInitialData("\])?\s*=\s*\{/i,"</script>","{"),a.html5player=T(r),a},O=async(e,t)=>{let r=new URL("https://www.youtube.com/get_video_info");r.searchParams.set("video_id",e),r.searchParams.set("c","TVHTML5"),r.searchParams.set("cver",`7${h.substr(1)}`),r.searchParams.set("eurl","https://youtube.googleapis.com/v/"+e),r.searchParams.set("ps","default"),r.searchParams.set("gl","US"),r.searchParams.set("hl",t.lang||"en"),r.searchParams.set("html5","1");let i=await o.exposedMiniget(r.toString(),t).text(),s=a.parse(i);return s.player_response=P("get_video_info",s),s},A=e=>{let t=[];return e&&e.streamingData&&(t=t.concat(e.streamingData.formats||[]).concat(e.streamingData.adaptiveFormats||[])),t};t.getInfo=async(e,r)=>{let a=await t.getBasicInfo(e,r),i=a.player_response&&a.player_response.streamingData&&(a.player_response.streamingData.dashManifestUrl||a.player_response.streamingData.hlsManifestUrl),s=[];if(a.formats.length){if(a.html5player=a.html5player||T(await R(e,r))||T(await _(e,r)),!a.html5player)throw Error("Unable to find html5player file");let t=new URL(a.html5player,m).toString();s.push(c.decipherFormats(a.formats,t,r))}if(i&&a.player_response.streamingData.dashManifestUrl){let e=a.player_response.streamingData.dashManifestUrl;s.push($(e,r))}if(i&&a.player_response.streamingData.hlsManifestUrl){let e=a.player_response.streamingData.hlsManifestUrl;s.push(V(e,r))}let o=await Promise.all(s);return a.formats=Object.values(Object.assign({},...o)),a.formats=a.formats.map(l.addFormatMeta),a.formats.sort(l.sortFormats),a.full=!0,a};let $=(e,t)=>new Promise((r,a)=>{let s,n={},l=i.parser(!1);l.onerror=a,l.onopentag=t=>{if("ADAPTATIONSET"===t.name)s=t.attributes;else if("REPRESENTATION"===t.name){let r=parseInt(t.attributes.ID);isNaN(r)||(n[e]=Object.assign({itag:r,url:e,bitrate:parseInt(t.attributes.BANDWIDTH),mimeType:`${s.MIMETYPE}; codecs="${t.attributes.CODECS}"`},t.attributes.HEIGHT?{width:parseInt(t.attributes.WIDTH),height:parseInt(t.attributes.HEIGHT),fps:parseInt(t.attributes.FRAMERATE)}:{audioSampleRate:t.attributes.AUDIOSAMPLINGRATE}))}},l.onend=()=>{r(n)};let d=o.exposedMiniget(new URL(e,m).toString(),t);d.setEncoding("utf8"),d.on("error",a),d.on("data",e=>{l.write(e)}),d.on("end",l.close.bind(l))}),V=async(e,t)=>{e=new URL(e,m);let r=await o.exposedMiniget(e.toString(),t).text(),a={};return r.split("\n").filter(e=>/^https?:\/\//.test(e)).forEach(e=>{let t=parseInt(e.match(/\/itag\/(\d+)\//)[1]);a[e]={itag:t,url:e}}),a};for(let e of["getBasicInfo","getInfo"]){let r=t[e];t[e]=async(a,i={})=>{o.checkForUpdates();let s=await d.getVideoID(a),n=[e,s,i.lang].join("-");return t.cache.getOrSet(n,()=>r(s,i))}}t.validateID=d.validateID,t.validateURL=d.validateURL,t.getURLVideoID=d.getURLVideoID,t.getVideoID=d.getVideoID},55389:(e,t,r)=>{let a=r(86624),i=r(8507),s=r(69871),o=r(41520);t.cache=new i,t.getFunctions=(e,r)=>t.cache.getOrSet(e,async()=>{let a=await s.exposedMiniget(e,r).text(),i=t.extractFunctions(a);if(!i||!i.length)throw Error("Could not extract functions");return t.cache.set(e,i),i}),t.extractFunctions=e=>{let t=[],r=t=>{let r=s.between(t,'a=a.split("");',".");if(!r)return"";let a=`var ${r}={`,i=e.indexOf(a);if(i<0)return"";let o=e.slice(i+a.length-1);return`var ${r}=${s.cutAfterJS(o)}`};return(()=>{let a=s.between(e,'a.set("alr","yes");c&&(c=',"(decodeURIC");if(a&&a.length){let i=`${a}=function(a)`,o=e.indexOf(i);if(o>=0){let n=e.slice(o+i.length),l=`var ${i}${s.cutAfterJS(n)}`;l=`${r(l)};${l};${a}(sig);`,t.push(l)}}})(),(()=>{let r=s.between(e,'&&(b=a.get("n"))&&(b=',"(b)");if(r.includes("[")&&(r=s.between(e,`var ${r.split("[")[0]}=[`,"]")),r&&r.length){let a=`${r}=function(a)`,i=e.indexOf(a);if(i>=0){let o=e.slice(i+a.length),n=`var ${a}${s.cutAfterJS(o)};${r}(ncode);`;t.push(n)}}})(),t},t.setDownloadURL=(e,t,r)=>{let i=!e.url,s=e.url||e.signatureCipher||e.cipher;e.url=(e=>{let t=new URL(decodeURIComponent(e)),a=t.searchParams.get("n");return a&&r?(t.searchParams.set("n",r.runInNewContext({ncode:a})),t.toString()):e})(i?(e=>{let r=a.parse(e);if(!r.s||!t)return r.url;let i=new URL(decodeURIComponent(r.url));return i.searchParams.set(r.sp?r.sp:"signature",t.runInNewContext({sig:decodeURIComponent(r.s)})),i.toString()})(s):s),delete e.signatureCipher,delete e.cipher},t.decipherFormats=async(e,r,a)=>{let i={},s=await t.getFunctions(r,a),n=s.length?new o.Script(s[0]):null,l=s.length>1?new o.Script(s[1]):null;return e.forEach(e=>{t.setDownloadURL(e,n,l),i[e.url]=e}),i}},46496:(e,t)=>{let r=new Set(["youtube.com","www.youtube.com","m.youtube.com","music.youtube.com","gaming.youtube.com"]),a=/^https?:\/\/(youtu\.be\/|(www\.)?youtube\.com\/(embed|v|shorts)\/)/;t.getURLVideoID=e=>{let i=new URL(e.trim()),o=i.searchParams.get("v");if(a.test(e.trim())&&!o){let e=i.pathname.split("/");o="youtu.be"===i.host?e[1]:e[2]}else if(i.hostname&&!r.has(i.hostname))throw Error("Not a YouTube domain");if(!o)throw Error(`No video id found: "${e}"`);if(o=o.substring(0,11),!t.validateID(o))throw TypeError(`Video id (${o}) does not match expected format (${s.toString()})`);return o};let i=/^https?:\/\//;t.getVideoID=e=>{if(t.validateID(e))return e;if(i.test(e.trim()))return t.getURLVideoID(e);throw Error(`No video id found: ${e}`)};let s=/^[a-zA-Z0-9-_]{11}$/;t.validateID=e=>s.test(e.trim()),t.validateURL=e=>{try{return t.getURLVideoID(e),!0}catch(e){return!1}}},69871:(e,t,r)=>{let a=r(3507);t.between=(e,t,r)=>{let a;if(t instanceof RegExp){let r=e.match(t);if(!r)return"";a=r.index+r[0].length}else{if(-1===(a=e.indexOf(t)))return"";a+=t.length}return -1===(a=(e=e.slice(a)).indexOf(r))?"":e=e.slice(0,a)},t.parseAbbreviatedNumber=e=>{let t=e.replace(",",".").replace(" ","").match(/([\d,.]+)([MK]?)/);if(t){let[,e,r]=t;return e=parseFloat(e),Math.round("M"===r?1e6*e:"K"===r?1e3*e:e)}return null};let i=[{start:'"',end:'"'},{start:"'",end:"'"},{start:"`",end:"`"},{start:"/",end:"/",startPrefix:/(^|[[{:;,/])\s?$/}];t.cutAfterJS=e=>{let t,r,a;if("["===e[0]?(t="[",r="]"):"{"===e[0]&&(t="{",r="}"),!t)throw Error(`Can't cut unsupported JSON (need to begin with [ or { ) but got: ${e[0]}`);let s=null,o=!1,n=0;for(a=0;a<e.length;a++){if(o||null===s||e[a]!==s.end){if(!o&&null===s){for(let t of i)if(e[a]===t.start&&(!t.startPrefix||e.substring(a-10,a).match(t.startPrefix))){s=t;break}if(null!==s)continue}}else{s=null;continue}if(o="\\"===e[a]&&!o,null===s&&(e[a]===t?n++:e[a]===r&&n--,0===n))return e.substring(0,a+1)}throw Error("Can't cut unsupported JSON (no matching closing bracket found)")},t.playError=(e,t,r=Error)=>{let a=e&&e.playabilityStatus;return a&&t.includes(a.status)?new r(a.reason||a.messages&&a.messages[0]):null},t.exposedMiniget=(e,t={},r)=>{let i=a(e,r||t.requestOptions);return"function"==typeof t.requestCallback&&t.requestCallback(i),i},t.deprecate=(e,t,r,a,i)=>{Object.defineProperty(e,t,{get:()=>(console.warn(`\`${a}\` will be removed in a near future release, use \`${i}\` instead.`),r)})};let s=r(3892);t.lastUpdateCheck=0,t.checkForUpdates=()=>!process.env.YTDL_NO_UPDATE&&!s.version.startsWith("0.0.0-")&&Date.now()-t.lastUpdateCheck>=432e5?(t.lastUpdateCheck=Date.now(),a("https://api.github.com/repos/fent/node-ytdl-core/releases/latest",{headers:{"User-Agent":"ytdl-core"}}).text().then(e=>{JSON.parse(e).tag_name!==`v${s.version}`&&console.warn('\x1b[33mWARNING:\x1b[0m ytdl-core is out of date! Update with "npm install ytdl-core@latest".')},e=>{console.warn("Error checking for updates:",e.message),console.warn("You can disable this check by setting the `YTDL_NO_UPDATE` env variable.")})):null,t.getRandomIPv6=e=>{if(!n(e))throw Error("Invalid IPv6 format");let[t,r]=e.split("/"),a=parseInt(r);if(!a||a>128||a<24)throw Error("Invalid IPv6 subnet");let i=l(t);return Array(8).fill(1).map(()=>Math.floor(65535*Math.random())).map((e,t)=>{let r=Math.min(a,16);a-=r;let s=65535-(2**(16-r)-1);return(i[t]&s)+(e&(65535^s))}).map(e=>e.toString("16")).join(":")};let o=/^(([0-9a-f]{1,4}:)(:[0-9a-f]{1,4}){1,6}|([0-9a-f]{1,4}:){1,2}(:[0-9a-f]{1,4}){1,5}|([0-9a-f]{1,4}:){1,3}(:[0-9a-f]{1,4}){1,4}|([0-9a-f]{1,4}:){1,4}(:[0-9a-f]{1,4}){1,3}|([0-9a-f]{1,4}:){1,5}(:[0-9a-f]{1,4}){1,2}|([0-9a-f]{1,4}:){1,6}(:[0-9a-f]{1,4})|([0-9a-f]{1,4}:){1,7}(([0-9a-f]{1,4})|:))\/(1[0-1]\d|12[0-8]|\d{1,2})$/,n=t.isIPv6=e=>o.test(e),l=t.normalizeIP=e=>{let t=e.split("::").map(e=>e.split(":")),r=t[0]||[],a=t[1]||[];a.reverse();let i=Array(8).fill(0);for(let e=0;e<Math.min(r.length,8);e++)i[e]=parseInt(r[e],16)||0;for(let e=0;e<Math.min(a.length,8);e++)i[7-e]=parseInt(a[e],16)||0;return i}},3892:e=>{"use strict";e.exports=JSON.parse('{"name":"ytdl-core","description":"YouTube video downloader in pure javascript.","keywords":["youtube","video","download"],"version":"4.11.5","repository":{"type":"git","url":"git://github.com/fent/node-ytdl-core.git"},"author":"fent <fentbox@gmail.com> (https://github.com/fent)","contributors":["Tobias Kutscha (https://github.com/TimeForANinja)","Andrew Kelley (https://github.com/andrewrk)","Mauricio Allende (https://github.com/mallendeo)","Rodrigo Altamirano (https://github.com/raltamirano)","Jim Buck (https://github.com/JimmyBoh)","Paweł Ruciński (https://github.com/Roki100)","Alexander Paolini (https://github.com/Million900o)"],"main":"./lib/index.js","types":"./typings/index.d.ts","files":["lib","typings"],"scripts":{"test":"nyc --reporter=lcov --reporter=text-summary npm run test:unit","test:unit":"mocha --ignore test/irl-test.js test/*-test.js --timeout 4000","test:irl":"mocha --timeout 16000 test/irl-test.js","lint":"eslint ./","lint:fix":"eslint --fix ./","lint:typings":"tslint typings/index.d.ts","lint:typings:fix":"tslint --fix typings/index.d.ts"},"dependencies":{"m3u8stream":"^0.8.6","miniget":"^4.2.2","sax":"^1.1.3"},"devDependencies":{"@types/node":"^13.1.0","assert-diff":"^3.0.1","dtslint":"^3.6.14","eslint":"^6.8.0","mocha":"^7.0.0","muk-require":"^1.2.0","nock":"^13.0.4","nyc":"^15.0.0","sinon":"^9.0.0","stream-equal":"~1.1.0","typescript":"^3.9.7"},"engines":{"node":">=12"},"license":"MIT"}')}};