(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{487:function(e,r,a){Promise.resolve().then(a.bind(a,7235))},7235:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return g}});var s=a(7437),t=a(2265),o=a(9376),l=a(7124),i=a(471),d=a(8497),n=a(2e3),c=a(6202),m=a(2690),u=a(4345),x=a(5057);function g(){let e=(0,o.useRouter)(),{user:r,supabase:a}=(0,l.$)(),{canGenerateNotes:g,canSaveNotes:v,canUseQuizzes:h,refreshUsage:p}=(0,i.m)(),[b,y]=(0,t.useState)(null),[f,j]=(0,t.useState)(""),[N,w]=(0,t.useState)(!1),[k,S]=(0,t.useState)(""),[D,V]=(0,t.useState)(!1),[C,M]=(0,t.useState)(0),[E,A]=(0,t.useState)(0),[P,T]=(0,t.useState)(0),[z,q]=(0,t.useState)("idle"),[B,L]=(0,t.useState)(null),[O,U]=(0,t.useState)(!0),[I,H]=(0,t.useState)(!1),[F,Z]=(0,t.useState)(!1),[_,G]=(0,t.useState)({title:"",message:"",feature:""}),R=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?V(!0):"dragleave"===e.type&&V(!1)},K=e=>{if(e.size>104857600){S("File size must be less than 100MB");return}if(!["video/mp4","video/mov","video/quicktime","video/webm","video/avi","video/mkv"].includes(e.type)){S("Please upload a video file (.mp4, .mov, .webm, .avi, .mkv)");return}y(e),S("")},W=async e=>{if(e.preventDefault(),!b){S("Please select a video file to upload");return}if(!r){H(!0);return}if(!g){G({title:"Monthly Limit Reached",message:"You've reached your plan limit. Upgrade your plan to generate more notes.",feature:"additional note generation"}),Z(!0);return}if(!v){G({title:"Storage Limit Reached",message:"You've reached your plan limit. Upgrade your plan to store more notes.",feature:"additional note storage"}),Z(!0);return}w(!0),S(""),q("uploading"),M(0);try{let{data:{session:e}}=await a.auth.getSession();if(!(null==e?void 0:e.access_token)){S("Authentication required. Please log in again.");return}let r=new FormData;r.append("file",b),f.trim()&&r.append("title",f.trim());let s=new XMLHttpRequest;s.upload.addEventListener("progress",e=>{if(e.lengthComputable){let r=Math.round(e.loaded/e.total*100);M(r)}});let t=new Promise((e,r)=>{s.addEventListener("load",()=>{if(s.status>=200&&s.status<300)try{let r=JSON.parse(s.responseText);e(r)}catch(e){r(Error("Invalid response format"))}else try{let e=JSON.parse(s.responseText);r(Error(e.message||"Upload failed"))}catch(e){r(Error("Upload failed with status ".concat(s.status)))}}),s.addEventListener("error",()=>{r(Error("Network error during upload"))})});s.open("POST","/api/upload-video"),s.setRequestHeader("Authorization","Bearer ".concat(e.access_token)),s.send(r);let o=await t;if(o.success&&o.data)L(o.data),q("complete"),await p();else throw Error(o.message||"Failed to process video")}catch(e){S(e.message||"Failed to process video. Please try again."),console.error("Error:",e),q("idle")}finally{w(!1)}},Y=(e,r,a)=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-4 rounded-xl transition-all duration-300 ".concat(r?"transform scale-105":""),style:{background:r?"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)":a?"linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(22, 163, 74, 0.2))":"var(--bg-secondary)",border:"1px solid ".concat(r?"var(--color-video)":a?"rgba(34, 197, 94, 0.3)":"var(--bg-tertiary)"),boxShadow:r?"var(--glow-video)":"var(--shadow-sm)"},children:[(0,s.jsx)("span",{className:"text-2xl",children:(()=>{switch(e){case"uploading":return"\uD83D\uDCE4";case"transcribing":return"\uD83C\uDFA4";case"generating":return"\uD83E\uDDE0";case"complete":return"✅";default:return"⭕"}})()}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-semibold",style:{color:r?"var(--bg-primary)":a?"#22c55e":"var(--text-primary)"},children:(()=>{switch(e){case"uploading":return"Uploading Video";case"transcribing":return"Transcribing Audio";case"generating":return"Generating Notes";case"complete":return"Complete";default:return"Waiting"}})()}),r&&"uploading"===e&&(0,s.jsx)("div",{className:"w-32 rounded-full h-2 mt-1",style:{background:"rgba(255, 255, 255, 0.3)"},children:(0,s.jsx)("div",{className:"h-2 rounded-full transition-all duration-300",style:{width:"".concat(C,"%"),background:"white"}})})]})]});return(0,s.jsxs)("div",{className:"min-h-screen",style:{background:"var(--bg-primary)"},children:[N&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(31, 34, 53, 0.9)",backdropFilter:"blur(5px)"},children:(0,s.jsx)("div",{className:"p-8 max-w-md mx-4 rounded-2xl",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-xl)"},children:(0,s.jsx)(x.Z,{message:"Processing Video...",subMessage:"This could take 5-10 minutes – please wait while we transcribe and analyze your video."})})}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4",style:{background:"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)",boxShadow:"var(--glow-video)"},children:(0,s.jsx)("svg",{className:"w-10 h-10",fill:"white",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"})})}),(0,s.jsx)("h1",{className:"text-4xl font-bold mb-4",style:{color:"var(--text-primary)"},children:"Upload Video for Notes"}),(0,s.jsx)("p",{className:"text-lg leading-relaxed",style:{color:"var(--text-secondary)"},children:"Upload your video files and convert them into comprehensive notes using AI transcription and analysis."})]}),B?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"rounded-2xl p-4",style:{background:"linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(22, 163, 74, 0.1))",border:"1px solid rgba(34, 197, 94, 0.3)",boxShadow:"0 0 20px rgba(34, 197, 94, 0.1)"},children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-2xl mr-3",children:"✅"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",style:{color:"#22c55e"},children:"Notes Generated Successfully!"}),(0,s.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Your video has been processed and notes have been generated."})]})]})}),(0,s.jsxs)("div",{className:"rounded-2xl p-6",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",style:{color:"var(--text-primary)"},children:B.title}),(0,s.jsxs)("div",{className:"note-view-toggle",children:[(0,s.jsx)("button",{onClick:()=>U(!0),className:"px-4 py-2 rounded-l-xl border transition-all duration-300 ".concat(O?"transform scale-105":""),style:{background:O?"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)":"var(--bg-primary)",color:O?"var(--bg-primary)":"var(--text-secondary)",borderColor:"var(--bg-tertiary)",boxShadow:O?"var(--glow-video)":"var(--shadow-sm)"},children:"\uD83D\uDCD6 Full Notes"}),(0,s.jsx)("button",{onClick:()=>U(!1),className:"px-4 py-2 rounded-r-xl border-t border-r border-b transition-all duration-300 ".concat(O?"":"transform scale-105"),style:{background:O?"var(--bg-primary)":"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)",color:O?"var(--text-secondary)":"var(--bg-primary)",borderColor:"var(--bg-tertiary)",boxShadow:O?"var(--shadow-sm)":"var(--glow-video)"},children:"\uD83D\uDCDD Summary"})]})]}),(0,s.jsx)("div",{className:"prose max-w-none prose-invert",style:{color:"var(--text-secondary)"},children:O?(0,s.jsx)(c.UG,{children:B.content}):(0,s.jsxs)("div",{className:"summary-section",children:[(0,s.jsx)("h3",{style:{color:"var(--text-primary)"},children:"\uD83D\uDCDD Summary Version"}),(0,s.jsx)(c.UG,{children:B.summary||"Summary not available."})]})})]}),B.quiz&&B.quiz.length>0&&(0,s.jsxs)("div",{className:"rounded-2xl p-6",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--text-primary)"},children:"\uD83D\uDCDD Test Your Knowledge"}),h?(0,s.jsx)(m.Z,{questions:B.quiz,noteId:B.id,noteType:"video",onComplete:(e,r)=>{console.log("Quiz completed: ".concat(e,"% (").concat(e*r/100,"/").concat(r,")"))}}):(0,s.jsx)(u.Z,{questionCount:B.quiz.length})]}),(0,s.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,s.jsx)("button",{onClick:()=>{y(null),j(""),S(""),q("idle"),M(0),A(0),T(0),L(null)},className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)",color:"var(--bg-primary)",boxShadow:"var(--glow-video)"},children:"Upload Another Video"}),(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"var(--bg-secondary)",color:"var(--text-secondary)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-sm)"},children:"View All Notes"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"rounded-2xl p-6 mb-8",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,s.jsx)("h3",{className:"font-semibold mb-3",style:{color:"var(--color-video)"},children:"Supported video formats:"}),(0,s.jsxs)("ul",{className:"list-disc list-inside space-y-2",style:{color:"var(--text-secondary)"},children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"MP4 files"})," - Most common video format"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"MOV files"})," - Apple QuickTime format"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"WEBM files"})," - Web-optimized format"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"AVI files"})," - Audio Video Interleave format"]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"MKV files"})," - Matroska video format"]})]}),(0,s.jsx)("div",{className:"mt-4 p-4 rounded-xl",style:{background:"linear-gradient(135deg, rgba(251, 191, 36, 0.1), rgba(245, 158, 11, 0.1))",border:"1px solid rgba(251, 191, 36, 0.3)"},children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("span",{className:"text-xl",children:"⏱️"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",style:{color:"#f59e0b"},children:"Processing Time Notice"}),(0,s.jsxs)("p",{className:"text-sm mb-2",style:{color:"var(--text-secondary)"},children:[(0,s.jsx)("strong",{children:"Video processing typically takes 5-10 minutes"})," depending on video length. Please be patient while we:"]}),(0,s.jsxs)("ul",{className:"text-sm list-disc list-inside ml-2 space-y-1",style:{color:"var(--text-secondary)"},children:[(0,s.jsx)("li",{children:"Extract and transcribe audio using AI speech recognition"}),(0,s.jsx)("li",{children:"Generate comprehensive notes from the transcript"}),(0,s.jsx)("li",{children:"Create practice quizzes and summaries"})]}),(0,s.jsx)("p",{className:"text-sm mt-2 font-semibold",style:{color:"#f59e0b"},children:"\uD83D\uDCA1 Keep this tab open during processing - closing it may interrupt the upload."})]})]})})]}),k&&(0,s.jsx)("div",{className:"rounded-2xl p-4 mb-6",style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1))",border:"1px solid rgba(239, 68, 68, 0.3)",boxShadow:"0 0 20px rgba(239, 68, 68, 0.1)"},children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("span",{className:"text-2xl mr-3",children:"❌"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",style:{color:"#ef4444"},children:"Upload Error"}),(0,s.jsx)("p",{className:"mb-3",style:{color:"#ef4444"},children:k}),(0,s.jsxs)("details",{className:"rounded p-3",style:{background:"rgba(239, 68, 68, 0.05)"},children:[(0,s.jsx)("summary",{className:"cursor-pointer text-sm font-semibold mb-2",style:{color:"#ef4444"},children:"\uD83D\uDD0D Troubleshooting Tips"}),(0,s.jsxs)("div",{className:"text-sm space-y-2",style:{color:"var(--text-secondary)"},children:[(0,s.jsx)("p",{children:(0,s.jsx)("strong",{children:'If you\'re getting a "not a valid video" error:'})}),(0,s.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,s.jsx)("li",{children:"Make sure your file is a video (MP4, MOV, WEBM, AVI, MKV)"}),(0,s.jsx)("li",{children:"Ensure the video contains audio (required for transcription)"}),(0,s.jsx)("li",{children:"Try a different video file to test"}),(0,s.jsx)("li",{children:"Check that the file isn't corrupted"})]}),(0,s.jsx)("p",{children:(0,s.jsx)("strong",{children:"If upload keeps failing:"})}),(0,s.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,s.jsx)("li",{children:"Try a smaller video file (under 50MB)"}),(0,s.jsx)("li",{children:"Check your internet connection"}),(0,s.jsx)("li",{children:"Refresh the page and try again"})]}),(0,s.jsxs)("p",{className:"text-xs mt-3",style:{color:"#ef4444"},children:[(0,s.jsx)("strong",{children:"Supported formats:"})," MP4 (recommended), MOV, WEBM, AVI, MKV with audio"]})]})]})]})]})}),N&&(0,s.jsxs)("div",{className:"rounded-2xl p-6 mb-8",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Processing Your Video"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Y("uploading","uploading"===z,["transcribing","generating","complete"].includes(z)),Y("transcribing","transcribing"===z,["generating","complete"].includes(z)),Y("generating","generating"===z,"complete"===z)]}),"uploading"===z&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("p",{className:"text-sm text-center",style:{color:"var(--text-secondary)"},children:["Uploading: ",C,"%"]})})]}),(0,s.jsx)("div",{className:"rounded-2xl p-8 mb-8",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:(0,s.jsxs)("form",{onSubmit:W,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"title",className:"block text-sm font-semibold mb-3",style:{color:"var(--text-primary)"},children:"Title (Optional)"}),(0,s.jsx)("input",{type:"text",id:"title",value:f,onChange:e=>j(e.target.value),placeholder:"Enter a custom title for your notes...",className:"w-full px-4 py-3 rounded-xl transition-all duration-300 focus:ring-2 focus:ring-[var(--color-video)] focus:outline-none",style:{background:"var(--bg-primary)",border:"1px solid var(--bg-tertiary)",color:"var(--text-primary)",boxShadow:"var(--shadow-sm)"},disabled:N}),(0,s.jsx)("p",{className:"mt-2 text-sm",style:{color:"var(--text-muted)"},children:"Give your notes a descriptive title to help you find them later"})]}),(0,s.jsx)("div",{className:"border-2 border-dashed rounded-2xl p-8 text-center transition-all duration-300 ".concat(D?"scale-102":b?"scale-102":"hover:scale-101"),style:{borderColor:D?"var(--color-video)":b?"var(--color-video)":"var(--bg-tertiary)",background:D||b?"linear-gradient(135deg, rgba(255, 165, 0, 0.1), rgba(255, 140, 0, 0.1))":"var(--bg-primary)",boxShadow:D||b?"var(--glow-video)":"var(--shadow-sm)"},onDragEnter:R,onDragLeave:R,onDragOver:R,onDrop:e=>{e.preventDefault(),e.stopPropagation(),V(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&K(e.dataTransfer.files[0])},children:b?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto",style:{background:"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)",boxShadow:"var(--glow-video)"},children:(0,s.jsx)("svg",{className:"w-8 h-8",fill:"white",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:b.name}),(0,s.jsxs)("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[(b.size/1024/1024).toFixed(2)," MB"]})]}),(0,s.jsx)("button",{type:"button",onClick:()=>y(null),className:"px-4 py-2 rounded-xl font-semibold transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, #ef4444, #dc2626)",color:"white",boxShadow:"0 0 20px rgba(239, 68, 68, 0.3)"},disabled:N,children:"Remove file"})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center mx-auto",style:{background:"var(--bg-tertiary)",border:"2px dashed var(--bg-tertiary)"},children:(0,s.jsx)("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 24 24",style:{color:"var(--text-muted)"},children:(0,s.jsx)("path",{d:"M14,2V8H20L14,2M15,22H5C4.45,22 4,21.55 4,21V3C4,2.45 4.45,2 5,2H13L19,8V21C19,21.55 18.55,22 18,22H15Z"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Drag and drop your video here"}),(0,s.jsx)("p",{className:"mb-3",style:{color:"var(--text-muted)"},children:"or"}),(0,s.jsxs)("label",{className:"cursor-pointer",children:[(0,s.jsx)("span",{className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 inline-block",style:{background:"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)",color:"var(--bg-primary)",boxShadow:"var(--glow-video)"},children:"browse to choose a video file"}),(0,s.jsx)("input",{type:"file",className:"hidden",accept:"video/mp4,video/mov,video/quicktime,video/webm,video/avi,video/mkv",onChange:e=>{var r;let a=null===(r=e.target.files)||void 0===r?void 0:r[0];a&&K(a)},disabled:N})]})]}),(0,s.jsx)("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"MP4, MOV, WEBM, AVI, MKV up to 100MB"})]})}),(0,s.jsx)("button",{type:"submit",disabled:N||!b,className:"w-full py-4 px-6 rounded-xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",style:{background:N||!b?"var(--bg-tertiary)":"linear-gradient(135deg, var(--color-video) 0%, var(--color-cta) 100%)",color:N||!b?"var(--text-muted)":"var(--bg-primary)",boxShadow:N||!b?"var(--shadow-sm)":"var(--glow-video)"},children:N?"Processing...":"Generate Notes from Video"})]})}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("button",{onClick:()=>e.push("/"),className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"var(--bg-secondary)",color:"var(--text-secondary)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-sm)"},children:"← Back to Home"})})]})]})}),I&&(0,s.jsx)(d.Z,{isOpen:I,onClose:()=>H(!1),title:"Sign In to Upload Videos",message:"Please sign in to start generating educational notes from your uploaded video files."}),F&&(0,s.jsx)(n.Z,{isOpen:F,onClose:()=>Z(!1),title:_.title,message:_.message,feature:_.feature})]})}}},function(e){e.O(0,[395,202,471,34,842,971,117,744],function(){return e(e.s=487)}),_N_E=e.O()}]);