(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{487:function(e,s,a){Promise.resolve().then(a.bind(a,7235))},7235:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return p}});var t=a(7437),r=a(29),l=a.n(r),i=a(2265),n=a(9376),d=a(7124),o=a(471),c=a(8497),b=a(2e3),x=a(6202),m=a(2690),u=a(4345),j=a(5057);function p(){let e=(0,n.useRouter)(),{user:s,supabase:a}=(0,d.$)(),{canGenerateNotes:r,canSaveNotes:p,canUseQuizzes:h,refreshUsage:g}=(0,o.m)(),[N,f]=(0,i.useState)(null),[v,y]=(0,i.useState)(""),[w,D]=(0,i.useState)(!1),[k,C]=(0,i.useState)(""),[M,S]=(0,i.useState)(!1),[E,V]=(0,i.useState)(0),[P,A]=(0,i.useState)(0),[T,z]=(0,i.useState)(0),[q,O]=(0,i.useState)("idle"),[U,F]=(0,i.useState)(null),[I,B]=(0,i.useState)(!0),[_,G]=(0,i.useState)(!1),[L,R]=(0,i.useState)(!1),[K,W]=(0,i.useState)({title:"",message:"",feature:""}),Y=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?S(!0):"dragleave"===e.type&&S(!1)},Z=e=>{if(e.size>104857600){C("File size must be less than 100MB");return}if(!["video/mp4","video/mov","video/quicktime","video/webm","video/avi","video/mkv"].includes(e.type)){C("Please upload a video file (.mp4, .mov, .webm, .avi, .mkv)");return}f(e),C("")},H=async e=>{if(e.preventDefault(),!N){C("Please select a video file to upload");return}if(!s){G(!0);return}if(!r){W({title:"Monthly Limit Reached",message:"You've reached your plan limit. Upgrade your plan to generate more notes.",feature:"additional note generation"}),R(!0);return}if(!p){W({title:"Storage Limit Reached",message:"You've reached your plan limit. Upgrade your plan to store more notes.",feature:"additional note storage"}),R(!0);return}D(!0),C(""),O("uploading"),V(0);try{let{data:{session:e}}=await a.auth.getSession();if(!(null==e?void 0:e.access_token)){C("Authentication required. Please log in again.");return}let s=new FormData;s.append("file",N),v.trim()&&s.append("title",v.trim());let t=new XMLHttpRequest;t.upload.addEventListener("progress",e=>{if(e.lengthComputable){let s=Math.round(e.loaded/e.total*100);V(s)}});let r=new Promise((e,s)=>{t.addEventListener("load",()=>{if(t.status>=200&&t.status<300)try{let s=JSON.parse(t.responseText);e(s)}catch(e){s(Error("Invalid response format"))}else try{let e=JSON.parse(t.responseText);s(Error(e.message||"Upload failed"))}catch(e){s(Error("Upload failed with status ".concat(t.status)))}}),t.addEventListener("error",()=>{s(Error("Network error during upload"))})});t.open("POST","/api/upload-video"),t.setRequestHeader("Authorization","Bearer ".concat(e.access_token)),t.send(s);let l=await r;if(l.success&&l.data)F(l.data),O("complete"),await g();else throw Error(l.message||"Failed to process video")}catch(e){C(e.message||"Failed to process video. Please try again."),console.error("Error:",e),O("idle")}finally{D(!1)}},J=(e,s,a)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg ".concat(s?"bg-blue-50 border-2 border-blue-200":a?"bg-green-50 border-2 border-green-200":"bg-gray-50 border-2 border-gray-200"),children:[(0,t.jsx)("span",{className:"text-2xl",children:(()=>{switch(e){case"uploading":return"\uD83D\uDCE4";case"transcribing":return"\uD83C\uDFA4";case"generating":return"\uD83E\uDDE0";case"complete":return"✅";default:return"⭕"}})()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium ".concat(s?"text-blue-900":a?"text-green-900":"text-gray-600"),children:(()=>{switch(e){case"uploading":return"Uploading Video";case"transcribing":return"Transcribing Audio";case"generating":return"Generating Notes";case"complete":return"Complete";default:return"Waiting"}})()}),s&&"uploading"===e&&(0,t.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:(0,t.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(E,"%")}})})]})]});return(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 min-h-screen bg-gray-50",children:[w&&(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50",children:(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 bg-white rounded-lg p-8 max-w-md mx-4",children:(0,t.jsx)(j.Z,{message:"Processing Video...",subMessage:"This could take 5-10 minutes – please wait while we transcribe and analyze your video."})})}),(0,t.jsx)("main",{className:"jsx-268953a7bbe95752 container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 text-center mb-8",children:[(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-4xl",children:"\uD83C\uDFA5"})}),(0,t.jsx)("h1",{className:"jsx-268953a7bbe95752 text-3xl font-bold text-gray-900 mb-4",children:"Upload Video for Notes"}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-lg text-gray-600",children:"Upload your video files and convert them into comprehensive notes using AI transcription and analysis."})]}),U?(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 space-y-6",children:[(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 bg-green-50 border border-green-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 flex items-center",children:[(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-2xl mr-3",children:"✅"}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("h3",{className:"jsx-268953a7bbe95752 text-lg font-semibold text-green-900",children:"Notes Generated Successfully!"}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-green-700",children:"Your video has been processed and notes have been generated."})]})]})}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 bg-white rounded-lg shadow-sm p-6",children:[(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"jsx-268953a7bbe95752 text-xl font-semibold text-gray-900",children:U.title}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 note-view-toggle",children:[(0,t.jsx)("button",{onClick:()=>B(!0),className:"jsx-268953a7bbe95752 "+"px-4 py-2 rounded-l-lg border ".concat(I?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"),children:"\uD83D\uDCD6 Full Notes"}),(0,t.jsx)("button",{onClick:()=>B(!1),className:"jsx-268953a7bbe95752 "+"px-4 py-2 rounded-r-lg border-t border-r border-b ".concat(I?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-purple-600 text-white border-purple-600"),children:"\uD83D\uDCDD Summary"})]})]}),(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 prose max-w-none",children:I?(0,t.jsx)(x.UG,{children:U.content}):(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 summary-section",children:[(0,t.jsx)("h3",{className:"jsx-268953a7bbe95752",children:"\uD83D\uDCDD Summary Version"}),(0,t.jsx)(x.UG,{children:U.summary||"Summary not available."})]})})]}),U.quiz&&U.quiz.length>0&&(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 bg-white rounded-lg shadow-sm p-6",children:[(0,t.jsx)("h2",{className:"jsx-268953a7bbe95752 text-xl font-semibold text-gray-900 mb-4",children:"\uD83D\uDCDD Test Your Knowledge"}),h?(0,t.jsx)(m.Z,{questions:U.quiz,noteId:U.id,noteType:"video",onComplete:(e,s)=>{console.log("Quiz completed: ".concat(e,"% (").concat(e*s/100,"/").concat(s,")"))}}):(0,t.jsx)(u.Z,{questionCount:U.quiz.length})]}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 flex gap-4 justify-center",children:[(0,t.jsx)("button",{onClick:()=>{f(null),y(""),C(""),O("idle"),V(0),A(0),z(0),F(null)},className:"jsx-268953a7bbe95752 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Upload Another Video"}),(0,t.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"jsx-268953a7bbe95752 px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"View All Notes"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 bg-purple-50 border border-purple-200 rounded-lg p-6 mb-8",children:[(0,t.jsx)("h3",{className:"jsx-268953a7bbe95752 font-semibold text-purple-900 mb-3",children:"Supported video formats:"}),(0,t.jsxs)("ul",{className:"jsx-268953a7bbe95752 list-disc list-inside space-y-2 text-purple-800",children:[(0,t.jsxs)("li",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"MP4 files"})," - Most common video format"]}),(0,t.jsxs)("li",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"MOV files"})," - Apple QuickTime format"]}),(0,t.jsxs)("li",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"WEBM files"})," - Web-optimized format"]}),(0,t.jsxs)("li",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"AVI files"})," - Audio Video Interleave format"]}),(0,t.jsxs)("li",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"MKV files"})," - Matroska video format"]})]}),(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 mt-4 p-4 bg-amber-50 border border-amber-200 rounded-lg",children:(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 flex items-start gap-3",children:[(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-xl",children:"⏱️"}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("h4",{className:"jsx-268953a7bbe95752 font-semibold text-amber-800 mb-2",children:"Processing Time Notice"}),(0,t.jsxs)("p",{className:"jsx-268953a7bbe95752 text-sm text-amber-700 mb-2",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"Video processing typically takes 5-10 minutes"})," depending on video length. Please be patient while we:"]}),(0,t.jsxs)("ul",{className:"jsx-268953a7bbe95752 text-sm text-amber-700 list-disc list-inside ml-2 space-y-1",children:[(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Extract and transcribe audio using AI speech recognition"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Generate comprehensive notes from the transcript"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Create practice quizzes and summaries"})]}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-sm text-amber-700 mt-2 font-medium",children:"\uD83D\uDCA1 Keep this tab open during processing - closing it may interrupt the upload."})]})]})})]}),k&&(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 flex items-start",children:[(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-2xl mr-3",children:"❌"}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 flex-1",children:[(0,t.jsx)("h3",{className:"jsx-268953a7bbe95752 text-lg font-semibold text-red-900 mb-2",children:"Upload Error"}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-red-800 mb-3",children:k}),(0,t.jsxs)("details",{className:"jsx-268953a7bbe95752 bg-red-100 rounded p-3",children:[(0,t.jsx)("summary",{className:"jsx-268953a7bbe95752 cursor-pointer text-sm font-medium text-red-700 mb-2",children:"\uD83D\uDD0D Troubleshooting Tips"}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 text-sm text-red-700 space-y-2",children:[(0,t.jsx)("p",{className:"jsx-268953a7bbe95752",children:(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:'If you\'re getting a "not a valid video" error:'})}),(0,t.jsxs)("ul",{className:"jsx-268953a7bbe95752 list-disc list-inside ml-4 space-y-1",children:[(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Make sure your file is a video (MP4, MOV, WEBM, AVI, MKV)"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Ensure the video contains audio (required for transcription)"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Try a different video file to test"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Check that the file isn't corrupted"})]}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752",children:(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"If upload keeps failing:"})}),(0,t.jsxs)("ul",{className:"jsx-268953a7bbe95752 list-disc list-inside ml-4 space-y-1",children:[(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Try a smaller video file (under 50MB)"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Check your internet connection"}),(0,t.jsx)("li",{className:"jsx-268953a7bbe95752",children:"Refresh the page and try again"})]}),(0,t.jsxs)("p",{className:"jsx-268953a7bbe95752 text-xs mt-3 text-red-600",children:[(0,t.jsx)("strong",{className:"jsx-268953a7bbe95752",children:"Supported formats:"})," MP4 (recommended), MOV, WEBM, AVI, MKV with audio"]})]})]})]})]})}),w&&(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 bg-white rounded-lg shadow-lg p-6 mb-8",children:[(0,t.jsx)("h3",{className:"jsx-268953a7bbe95752 text-lg font-semibold text-gray-900 mb-4",children:"Processing Your Video"}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 grid grid-cols-1 md:grid-cols-3 gap-4",children:[J("uploading","uploading"===q,["transcribing","generating","complete"].includes(q)),J("transcribing","transcribing"===q,["generating","complete"].includes(q)),J("generating","generating"===q,"complete"===q)]}),"uploading"===q&&(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 mt-4",children:(0,t.jsxs)("p",{className:"jsx-268953a7bbe95752 text-sm text-gray-600 text-center",children:["Uploading: ",E,"%"]})})]}),(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 bg-white rounded-lg shadow-lg p-8",children:(0,t.jsxs)("form",{onSubmit:H,className:"jsx-268953a7bbe95752 space-y-6",children:[(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("label",{htmlFor:"title",className:"jsx-268953a7bbe95752 block text-sm font-medium text-gray-700 mb-2",children:"Title (Optional)"}),(0,t.jsx)("input",{type:"text",id:"title",value:v,onChange:e=>y(e.target.value),placeholder:"Enter a custom title for your notes...",disabled:w,className:"jsx-268953a7bbe95752 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500"}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 mt-1 text-sm text-gray-500",children:"Give your notes a descriptive title to help you find them later"})]}),(0,t.jsx)("div",{onDragEnter:Y,onDragLeave:Y,onDragOver:Y,onDrop:e=>{e.preventDefault(),e.stopPropagation(),S(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&Z(e.dataTransfer.files[0])},className:"jsx-268953a7bbe95752 "+"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(M?"border-purple-500 bg-purple-50":N?"border-purple-300 bg-purple-50":"border-gray-300 hover:border-purple-400"),children:N?(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 space-y-4",children:[(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto",children:(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-2xl",children:"\uD83C\uDFA5"})}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-lg font-medium text-gray-900",children:N.name}),(0,t.jsxs)("p",{className:"jsx-268953a7bbe95752 text-sm text-gray-500",children:[(N.size/1024/1024).toFixed(2)," MB"]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>f(null),disabled:w,className:"jsx-268953a7bbe95752 text-red-600 hover:text-red-800 text-sm",children:"Remove file"})]}):(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752 space-y-4",children:[(0,t.jsx)("div",{className:"jsx-268953a7bbe95752 w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto",children:(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-2xl",children:"\uD83C\uDFAC"})}),(0,t.jsxs)("div",{className:"jsx-268953a7bbe95752",children:[(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-lg font-medium text-gray-900",children:"Drag and drop your video here"}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-gray-500",children:"or"}),(0,t.jsxs)("label",{className:"jsx-268953a7bbe95752 cursor-pointer",children:[(0,t.jsx)("span",{className:"jsx-268953a7bbe95752 text-purple-600 hover:text-purple-800 font-medium",children:"browse to choose a video file"}),(0,t.jsx)("input",{type:"file",accept:"video/mp4,video/mov,video/quicktime,video/webm,video/avi,video/mkv",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&Z(a)},disabled:w,className:"jsx-268953a7bbe95752 hidden"})]})]}),(0,t.jsx)("p",{className:"jsx-268953a7bbe95752 text-sm text-gray-500",children:"MP4, MOV, WEBM, AVI, MKV up to 100MB"})]})}),(0,t.jsx)("button",{type:"submit",disabled:w||!N,className:"jsx-268953a7bbe95752 w-full bg-purple-600 text-white py-3 px-6 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:w?"Processing...":"Generate Notes from Video"})]})})]})]})}),_&&(0,t.jsx)(c.Z,{isOpen:_,onClose:()=>G(!1),title:"Sign In to Upload Videos",message:"Please sign in to start generating educational notes from your uploaded video files."}),L&&(0,t.jsx)(b.Z,{isOpen:L,onClose:()=>R(!1),title:K.title,message:K.message,feature:K.feature}),(0,t.jsx)(l(),{id:"268953a7bbe95752",children:".note-view-toggle.jsx-268953a7bbe95752{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-border-radius:.5rem;-moz-border-radius:.5rem;border-radius:.5rem;overflow:hidden}"})]})}}},function(e){e.O(0,[395,202,29,471,34,842,971,117,744],function(){return e(e.s=487)}),_N_E=e.O()}]);