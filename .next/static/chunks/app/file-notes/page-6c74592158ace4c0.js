(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{613:function(e,a,r){Promise.resolve().then(r.bind(r,2489))},2489:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return u}});var t=r(7437),o=r(2265),s=r(9376),l=r(6202),n=r(7124),i=r(471),d=r(2690),c=r(4345),x=r(2703);function m(){var e;let a=(0,s.useRouter)(),r=(0,s.useSearchParams)(),m=null==r?void 0:r.get("id"),{user:u,supabase:h}=(0,n.$)(),{canUseQuizzes:b}=(0,i.m)(),[g,p]=(0,o.useState)(null),[v,y]=(0,o.useState)(!0),[f,j]=(0,o.useState)(""),[N,w]=(0,o.useState)(!1),[D,k]=(0,o.useState)(!0),[C,S]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if(!m){j("No note ID provided"),y(!1);return}if(!u){j("Please log in to view notes"),y(!1);return}(async()=>{try{y(!0),j("");let{data:{session:e}}=await h.auth.getSession(),a=null==e?void 0:e.access_token;if(!a)throw Error("No authentication token available");console.log("[FileNotesPage] Fetching note with ID: ".concat(m));let r=await fetch("/api/file-notes",{method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to fetch notes")}let t=await r.json();if(!t.success||!t.data)throw Error("No notes data received");let o=t.data.find(e=>e.id===m);if(!o)throw Error("Note not found");console.log("[FileNotesPage] Note found:",o),p(o)}catch(e){console.error("[FileNotesPage] Error fetching note:",e),j(e.message||"Failed to load note")}finally{y(!1)}})()},[m,u,h]);let E=async()=>{if(m&&u)try{S(!0);let{data:{session:e}}=await h.auth.getSession(),r=null==e?void 0:e.access_token;if(!r)throw Error("No authentication token available");console.log("[FileNotesPage] Deleting note with ID: ".concat(m));let t=await fetch("/api/file-notes?id=".concat(m),{method:"DELETE",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to delete note")}console.log("[FileNotesPage] Successfully deleted note: ".concat(m)),a.push("/dashboard")}catch(e){console.error("[FileNotesPage] Error deleting note:",e),j(e.message||"Failed to delete note"),w(!1)}finally{S(!1)}};return u?v?(0,t.jsx)("div",{className:"min-h-screen",style:{background:"var(--bg-primary)"},children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full animate-spin mx-auto mb-6",style:{border:"4px solid var(--bg-tertiary)",borderTop:"4px solid var(--color-file)"}}),(0,t.jsx)("h2",{className:"text-2xl font-semibold",style:{color:"var(--text-primary)"},children:"Loading your file notes..."})]})})})}):f?(0,t.jsx)("div",{className:"min-h-screen",style:{background:"var(--bg-primary)"},children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"rounded-2xl p-8 text-center",style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1))",border:"1px solid rgba(239, 68, 68, 0.3)",boxShadow:"var(--shadow-lg)"},children:[(0,t.jsx)("div",{className:"text-6xl mb-6 opacity-80",children:"⚠️"}),(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",style:{color:"#ef4444"},children:"Something went wrong"}),(0,t.jsx)("p",{className:"text-lg mb-8 leading-relaxed",style:{color:"var(--text-secondary)"},children:f}),(0,t.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>a.push("/dashboard"),className:"px-8 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"linear-gradient(135deg, var(--color-cta) 0%, var(--color-file) 100%)",color:"var(--bg-primary)",boxShadow:"var(--glow-cta)"},children:"Back to Dashboard"}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"px-8 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"var(--bg-secondary)",color:"var(--text-secondary)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-sm)"},children:"Try Again"})]})]})})})}):g?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-2xl",children:(e=g.file_type)?e.includes("pdf")?"\uD83D\uDCD5":e.includes("word")||e.includes("doc")?"\uD83D\uDCD8":e.includes("presentation")||e.includes("powerpoint")?"\uD83D\uDCCA":e.includes("text")||e.includes("txt")?"\uD83D\uDCDD":e.includes("image")?"\uD83D\uDDBC️":"\uD83D\uDCC4":"\uD83D\uDCC4"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:[g.title||"File Notes"," – ",new Date(g.created_at).toLocaleDateString()]}),g.file_name&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83D\uDCCE Original file: ",g.file_name]}),g.file_type&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83C\uDFF7️ File type: ",g.file_type]}),g.slide_count&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83D\uDCCA Slides: ",g.slide_count]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(g.created_at).toLocaleString()]})]}),(0,t.jsx)("div",{className:"flex flex-col justify-end",children:(0,t.jsx)(x.Z,{noteId:g.id,noteType:"file",noteTitle:g.title||"File Notes",noteContent:D?g.content:g.summary||g.content,className:"text-sm"})})]})}),(0,t.jsxs)("div",{className:"rounded-2xl p-6 mb-6",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",style:{color:"var(--text-primary)"},children:"\uD83D\uDCC4 Notes"}),(0,t.jsxs)("div",{className:"note-view-toggle",children:[(0,t.jsx)("button",{onClick:()=>k(!1),className:D?"":"active",children:"Summary"}),(0,t.jsx)("button",{onClick:()=>k(!0),className:D?"active":"",children:"Full Notes"})]})]}),(0,t.jsx)("div",{className:"prose max-w-none prose-invert",style:{color:"var(--text-secondary)"},children:D?(0,t.jsx)(l.UG,{children:g.content}):(0,t.jsxs)("div",{className:"summary-section",children:[(0,t.jsx)("h3",{style:{color:"var(--text-primary)"},children:"\uD83D\uDCDD Summary Version"}),(0,t.jsx)(l.UG,{children:g.summary||"Summary not available."})]})})]}),g.file_url?(0,t.jsxs)("div",{className:"rounded-2xl p-6 mb-6",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Original File"}),(0,t.jsx)("a",{href:g.file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"linear-gradient(135deg, var(--color-file) 0%, var(--color-cta) 100%)",color:"var(--bg-primary)",boxShadow:"var(--glow-file)"},children:"\uD83D\uDCE5 Download Original File"})]}):(0,t.jsxs)("div",{className:"rounded-2xl p-6 mb-6",style:{background:"linear-gradient(135deg, rgba(255, 165, 0, 0.1), rgba(255, 165, 0, 0.05))",border:"1px solid rgba(255, 165, 0, 0.3)",boxShadow:"0 0 20px rgba(255, 165, 0, 0.1)"},children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",style:{color:"var(--color-video)"},children:"File Storage Notice"}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"The original file is not available for download. The file content was processed to generate notes, but file storage is not currently configured."})]}),g.quiz&&g.quiz.length>0&&(0,t.jsxs)("div",{className:"rounded-2xl p-6 mb-6",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--text-primary)"},children:"\uD83D\uDCDD Test Your Knowledge"}),b?(0,t.jsx)(d.Z,{questions:g.quiz,noteId:g.id,noteType:"file",onComplete:(e,a)=>{console.log("Quiz completed: ".concat(e,"% (").concat(e*a/100,"/").concat(a,")"))}}):(0,t.jsx)(c.Z,{questionCount:g.quiz.length})]}),(0,t.jsxs)("div",{className:"rounded-2xl p-6 mb-6",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-lg)"},children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Actions"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-4",children:(0,t.jsx)("button",{onClick:()=>a.push("/dashboard"),className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"var(--bg-primary)",color:"var(--text-secondary)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-sm)"},children:"\uD83D\uDCCB View All Notes"})})]})]})}),N&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(31, 34, 53, 0.9)",backdropFilter:"blur(5px)"},children:(0,t.jsxs)("div",{className:"rounded-2xl p-6 max-w-md w-full mx-4",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-xl)"},children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Delete Note"}),(0,t.jsx)("p",{className:"mb-6",style:{color:"var(--text-secondary)"},children:"Are you sure you want to delete this note? This action cannot be undone."}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:()=>w(!1),className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"var(--bg-primary)",color:"var(--text-secondary)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-sm)"},children:"Cancel"}),(0,t.jsx)("button",{onClick:E,disabled:C,className:"px-6 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",style:{background:C?"var(--bg-tertiary)":"linear-gradient(135deg, #ef4444, #dc2626)",color:C?"var(--text-muted)":"white",boxShadow:C?"var(--shadow-sm)":"0 0 20px rgba(239, 68, 68, 0.3)"},children:C?"Deleting...":"Delete Note"})]})]})})]}):(0,t.jsx)("div",{className:"min-h-screen",style:{background:"var(--bg-primary)"},children:(0,t.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsx)("div",{className:"text-center py-16",children:(0,t.jsxs)("div",{className:"rounded-2xl p-8 max-w-md mx-auto",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-xl)"},children:[(0,t.jsx)("div",{className:"text-6xl mb-6 opacity-80",children:"\uD83D\uDCC4"}),(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",style:{color:"var(--text-primary)"},children:"Note not found"}),(0,t.jsx)("p",{className:"text-lg mb-8 leading-relaxed",style:{color:"var(--text-secondary)"},children:"The requested file note could not be found"}),(0,t.jsx)("button",{onClick:()=>a.push("/dashboard"),className:"px-8 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"linear-gradient(135deg, var(--color-cta) 0%, var(--color-file) 100%)",color:"var(--bg-primary)",boxShadow:"var(--glow-cta)"},children:"Back to Dashboard"})]})})})})}):(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--bg-primary)"},children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)("div",{className:"rounded-2xl p-8 max-w-md mx-auto",style:{background:"linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%)",border:"1px solid var(--bg-tertiary)",boxShadow:"var(--shadow-xl)"},children:[(0,t.jsx)("div",{className:"text-6xl mb-6 opacity-80",children:"\uD83D\uDD10"}),(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",style:{color:"var(--text-primary)"},children:"Access Required"}),(0,t.jsx)("p",{className:"text-lg mb-6 leading-relaxed",style:{color:"var(--text-secondary)"},children:"Please log in to view your file notes"}),(0,t.jsx)("button",{onClick:()=>a.push("/"),className:"px-8 py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105",style:{background:"linear-gradient(135deg, var(--color-cta) 0%, var(--color-file) 100%)",color:"var(--bg-primary)",boxShadow:"var(--glow-cta)"},children:"Go to Login"})]})})})}function u(){return(0,t.jsx)(o.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"var(--bg-primary)"},children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 rounded-full animate-spin mx-auto mb-6",style:{border:"4px solid var(--bg-tertiary)",borderTop:"4px solid var(--color-file)"}}),(0,t.jsx)("p",{style:{color:"var(--text-secondary)"},children:"Loading file notes..."})]})}),children:(0,t.jsx)(m,{})})}},2703:function(e,a,r){"use strict";r.d(a,{Z:function(){return s}});var t=r(7437),o=r(2265);function s(e){let{noteId:a,noteType:r,noteTitle:s,noteContent:l,className:n=""}=e,[i,d]=(0,o.useState)(!1),[c,x]=(0,o.useState)(!1),m=async()=>{if(!i){d(!0);try{let e="EDUSCRIBE: ".concat(s,"\n\n").concat("=".repeat(50),"\n\n").concat(l,"\n\n").concat("=".repeat(50),"\nGenerated by EduScribe - AI-powered note generation\n").replace(/#{1,6}\s+/g,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\[(.*?)\]\(.*?\)/g,"$1").replace(/---+/g,"─".repeat(50)).replace(/•/g,"- ").replace(/📝|📖|🎥|📹|📄|📁|🧠|⭐|🔥/g,"").trim(),a=new Blob([e],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(a),t=document.createElement("a");t.href=r,t.download="eduscribe_note.txt",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(r),x(!0),setTimeout(()=>x(!1),3e3)}catch(e){console.error("Failed to export note:",e)}finally{d(!1)}}};return c?(0,t.jsx)("div",{className:"relative group",children:(0,t.jsxs)("button",{disabled:!0,className:"bg-green-600 text-white px-3 py-1.5 rounded-md flex items-center gap-2 ".concat(n),children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Downloaded!"]})}):i?(0,t.jsx)("div",{className:"relative group",children:(0,t.jsxs)("button",{disabled:!0,className:"bg-purple-600 text-white px-3 py-1.5 rounded-md flex items-center gap-2 ".concat(n),children:[(0,t.jsx)("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Exporting..."]})}):(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsxs)("button",{onClick:m,className:"bg-purple-600 text-white px-3 py-1.5 rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 ".concat(n),children:[(0,t.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export to Notatnik"]}),(0,t.jsx)("div",{className:"absolute bottom-full right-0 mb-2 hidden group-hover:block z-10",children:(0,t.jsxs)("div",{className:"bg-gray-900 text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap",children:["Downloads as .txt file - open with Notepad or any text editor",(0,t.jsx)("div",{className:"absolute top-full right-6 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})})]})}}},function(e){e.O(0,[395,202,471,34,971,117,744],function(){return e(e.s=613)}),_N_E=e.O()}]);