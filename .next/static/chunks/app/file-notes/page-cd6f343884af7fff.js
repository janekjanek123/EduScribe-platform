(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{613:function(e,t,s){Promise.resolve().then(s.bind(s,2489))},2489:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(7437),n=s(2265),l=s(9376),r=s(6202),o=s(7124),i=s(471),c=s(2690),d=s(4345),x=s(2703);function u(){var e;let t=(0,l.useRouter)(),s=(0,l.useSearchParams)(),u=null==s?void 0:s.get("id"),{user:m,supabase:h}=(0,o.$)(),{canUseQuizzes:g}=(0,i.m)(),[b,p]=(0,n.useState)(null),[j,N]=(0,n.useState)(!0),[f,y]=(0,n.useState)(""),[v,w]=(0,n.useState)(!1),[D,k]=(0,n.useState)(!0);(0,n.useEffect)(()=>{if(!u){y("No note ID provided"),N(!1);return}if(!m){y("Please log in to view notes"),N(!1);return}(async()=>{try{N(!0),y("");let{data:{session:e}}=await h.auth.getSession(),t=null==e?void 0:e.access_token;if(!t)throw Error("No authentication token available");console.log("[FileNotesPage] Fetching note with ID: ".concat(u));let s=await fetch("/api/file-notes",{method:"GET",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to fetch notes")}let a=await s.json();if(!a.success||!a.data)throw Error("No notes data received");let n=a.data.find(e=>e.id===u);if(!n)throw Error("Note not found");console.log("[FileNotesPage] Note found:",n),p(n)}catch(e){console.error("[FileNotesPage] Error fetching note:",e),y(e.message||"Failed to load note")}finally{N(!1)}})()},[u,m,h]);let C=async()=>{if(u&&m)try{let{data:{session:e}}=await h.auth.getSession(),s=null==e?void 0:e.access_token;if(!s)throw Error("No authentication token available");console.log("[FileNotesPage] Deleting note with ID: ".concat(u));let a=await fetch("/api/file-notes?id=".concat(u),{method:"DELETE",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to delete note")}console.log("[FileNotesPage] Successfully deleted note: ".concat(u)),t.push("/dashboard")}catch(e){console.error("[FileNotesPage] Error deleting note:",e),y(e.message||"Failed to delete note"),w(!1)}};return m?j?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-t-4 border-b-4 border-blue-600 rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Loading your file notes..."})]})})})}):f?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:f}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Back to Dashboard"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"Try Again"})]})]})})})}):b?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:(e=b.file_type)?e.includes("pdf")?"\uD83D\uDCD5":e.includes("word")||e.includes("doc")?"\uD83D\uDCD8":e.includes("presentation")||e.includes("powerpoint")?"\uD83D\uDCCA":e.includes("text")||e.includes("txt")?"\uD83D\uDCDD":e.includes("image")?"\uD83D\uDDBC️":"\uD83D\uDCC4":"\uD83D\uDCC4"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:[b.title||"File Notes"," – ",new Date(b.created_at).toLocaleDateString()]}),b.file_name&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83D\uDCCE Original file: ",b.file_name]}),b.file_type&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83C\uDFF7️ File type: ",b.file_type]}),b.slide_count&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\uD83D\uDCCA Slides: ",b.slide_count]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(b.created_at).toLocaleString()]})]}),(0,a.jsx)("div",{className:"flex flex-col justify-end",children:(0,a.jsx)(x.Z,{noteId:b.id,noteType:"file",noteTitle:b.title||"File Notes",noteContent:D?b.content:b.summary||b.content,className:"text-sm"})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Generated Notes"}),(0,a.jsx)("div",{className:"flex items-center gap-3",children:b.summary&&(0,a.jsxs)("div",{className:"note-view-toggle",children:[(0,a.jsx)("button",{onClick:()=>k(!0),className:D?"active":"",children:"\uD83D\uDCD6 View Full Notes"}),(0,a.jsx)("button",{onClick:()=>k(!1),className:D?"":"active",children:"\uD83D\uDCDD View Summary"})]})})]}),(0,a.jsx)("div",{className:"prose max-w-none",children:D?(0,a.jsx)(r.UG,{children:b.content}):(0,a.jsxs)("div",{className:"summary-section",children:[(0,a.jsx)("h3",{children:"\uD83D\uDCDD Summary Version"}),(0,a.jsx)(r.UG,{children:b.summary||"Summary not available."})]})})]}),b.file_url?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Original File"}),(0,a.jsx)("a",{href:b.file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"\uD83D\uDCE5 Download Original File"})]}):(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-yellow-800 mb-2",children:"File Storage Notice"}),(0,a.jsx)("p",{className:"text-yellow-700",children:"The original file is not available for download. The file content was processed to generate notes, but file storage is not currently configured."})]}),b.quiz&&b.quiz.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"\uD83D\uDCDD Test Your Knowledge"}),g?(0,a.jsx)(c.Z,{questions:b.quiz,noteId:b.id,noteType:"file",onComplete:(e,t)=>{console.log("Quiz completed: ".concat(e,"% (").concat(e*t/100,"/").concat(t,")"))}}):(0,a.jsx)(d.Z,{questionCount:b.quiz.length})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700",children:"← Back to Dashboard"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:()=>w(!0),className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Note"]}),(0,a.jsx)("button",{onClick:()=>t.push("/generate/upload"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Generate More Notes →"})]})]})]})}),v&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Note"})]}),(0,a.jsxs)("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete "',(0,a.jsx)("strong",{children:null==b?void 0:b.title}),'"? This action cannot be undone.']}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>w(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:C,className:"px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-md transition-colors",children:"Delete Note"})]})]})})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Note not found"}),(0,a.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Back to Dashboard"})]})})})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Please log in to view notes"}),(0,a.jsx)("button",{onClick:()=>t.push("/"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Go to Login"})]})})}function m(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading..."}),children:(0,a.jsx)(u,{})})}},2703:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),n=s(2265);function l(e){let{noteId:t,noteType:s,noteTitle:l,noteContent:r,className:o=""}=e,[i,c]=(0,n.useState)(!1),[d,x]=(0,n.useState)(!1),u=async()=>{if(!i){c(!0);try{let e="EDUSCRIBE: ".concat(l,"\n\n").concat("=".repeat(50),"\n\n").concat(r,"\n\n").concat("=".repeat(50),"\nGenerated by EduScribe - AI-powered note generation\n").replace(/#{1,6}\s+/g,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\[(.*?)\]\(.*?\)/g,"$1").replace(/---+/g,"─".repeat(50)).replace(/•/g,"- ").replace(/📝|📖|🎥|📹|📄|📁|🧠|⭐|🔥/g,"").trim(),t=new Blob([e],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download="eduscribe_note.txt",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),x(!0),setTimeout(()=>x(!1),3e3)}catch(e){console.error("Failed to export note:",e)}finally{c(!1)}}};return d?(0,a.jsx)("div",{className:"relative group",children:(0,a.jsxs)("button",{disabled:!0,className:"bg-green-600 text-white px-3 py-1.5 rounded-md flex items-center gap-2 ".concat(o),children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Downloaded!"]})}):i?(0,a.jsx)("div",{className:"relative group",children:(0,a.jsxs)("button",{disabled:!0,className:"bg-purple-600 text-white px-3 py-1.5 rounded-md flex items-center gap-2 ".concat(o),children:[(0,a.jsx)("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Exporting..."]})}):(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsxs)("button",{onClick:u,className:"bg-purple-600 text-white px-3 py-1.5 rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 ".concat(o),children:[(0,a.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export to Notatnik"]}),(0,a.jsx)("div",{className:"absolute bottom-full right-0 mb-2 hidden group-hover:block z-10",children:(0,a.jsxs)("div",{className:"bg-gray-900 text-white text-xs rounded-lg px-3 py-2 whitespace-nowrap",children:["Downloads as .txt file - open with Notepad or any text editor",(0,a.jsx)("div",{className:"absolute top-full right-6 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})})]})}}},function(e){e.O(0,[395,202,471,34,971,117,744],function(){return e(e.s=613)}),_N_E=e.O()}]);