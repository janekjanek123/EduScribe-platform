(()=>{var e={};e.id=8699,e.ids=[8699,2612],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},86624:e=>{"use strict";e.exports=require("querystring")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},95346:e=>{"use strict";e.exports=require("timers")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},41520:e=>{"use strict";e.exports=require("vm")},71568:e=>{"use strict";e.exports=require("zlib")},42195:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>b,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{GET:()=>p,POST:()=>l});var a=t(49303),i=t(88716),o=t(60670),n=t(87070),u=t(71007),c=t(73185);async function l(e){try{let{url:r,videoId:t,languages:s}=await e.json(),a=t;if(r&&!a&&(a=(0,c.jx)(r)),!a)return n.NextResponse.json({error:"No valid YouTube video ID or URL provided"},{status:400});if(!(0,c.cc)(a))return n.NextResponse.json({error:"Invalid YouTube video ID format"},{status:400});console.log(`[YouTube Transcript API] Processing video: ${a}`);let i=await (0,u.Bm)(a,s);if(i.error&&0===i.transcript.length){console.log(`[YouTube Transcript API] Primary method failed, trying fallback for ${a}`);let e=await (0,u.XH)(a);if(e.transcript&&e.transcript.length>0)return n.NextResponse.json({success:!0,transcript:e.transcript,language:e.language,method:"fallback",videoId:a})}if(i.transcript&&i.transcript.length>0)return n.NextResponse.json({success:!0,transcript:i.transcript,segments:i.segments,language:i.language,method:"primary",videoId:a});return n.NextResponse.json({success:!1,error:i.error||"No transcript available for this video",videoId:a},{status:404})}catch(e){return console.error("[YouTube Transcript API] Server error:",e),n.NextResponse.json({success:!1,error:"Internal server error while extracting transcript",details:e.message},{status:500})}}async function p(e){let r=e.nextUrl.searchParams,t=r.get("url"),s=r.get("videoId"),a=r.get("languages")?.split(","),i=s;if(t&&!i&&(i=(0,c.jx)(t)),!i)return n.NextResponse.json({error:"No valid YouTube video ID or URL provided"},{status:400});if(!(0,c.cc)(i))return n.NextResponse.json({error:"Invalid YouTube video ID format"},{status:400});try{console.log(`[YouTube Transcript API] Processing video (GET): ${i}`);let e=await (0,u.Bm)(i,a);if(e.transcript&&e.transcript.length>0)return n.NextResponse.json({success:!0,transcript:e.transcript,segments:e.segments,language:e.language,videoId:i});return n.NextResponse.json({success:!1,error:e.error||"No transcript available for this video",videoId:i},{status:404})}catch(e){return console.error("[YouTube Transcript API] Server error (GET):",e),n.NextResponse.json({success:!1,error:"Internal server error while extracting transcript",details:e.message},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/youtube-transcript/route",pathname:"/api/youtube-transcript",filename:"route",bundlePath:"app/api/youtube-transcript/route"},resolvedPagePath:"/Users/janjedrach/Cursor/eduscribe/src/app/api/youtube-transcript/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:f}=d,m="/api/youtube-transcript/route";function b(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}},13974:e=>{function r(e,r,t,s){return Math.round(e/t)+" "+s+(r>=1.5*t?"s":"")}e.exports=function(e,t){t=t||{};var s,a,i=typeof e;if("string"===i&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*t;case"weeks":case"week":case"w":return 6048e5*t;case"days":case"day":case"d":return 864e5*t;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*t;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*t;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}(e);if("number"===i&&isFinite(e))return t.long?(s=Math.abs(e))>=864e5?r(e,s,864e5,"day"):s>=36e5?r(e,s,36e5,"hour"):s>=6e4?r(e,s,6e4,"minute"):s>=1e3?r(e,s,1e3,"second"):e+" ms":(a=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":a>=36e5?Math.round(e/36e5)+"h":a>=6e4?Math.round(e/6e4)+"m":a>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},71007:(e,r,t)=>{"use strict";t.d(r,{Bm:()=>i,XH:()=>o});var s=t(25559),a=t(73185);async function i(e,r=["en","pl","es","fr","de"]){try{let t=e;if(e.includes("youtube.com")||e.includes("youtu.be")){let r=(0,a.jx)(e);if(!r)return{transcript:"",error:"Invalid YouTube URL format"};t=r}if(!(0,a.cc)(t))return{transcript:"",error:"Invalid YouTube video ID"};console.log(`[YouTubeTranscript] Extracting transcript for video: ${t}`);let i=null;for(let e of r)try{console.log(`[YouTubeTranscript] Trying language: ${e}`);let r=await s.Z.getTranscript(t,{lang:e,country:"US"});if(r&&r.length>0){let t=r.map(e=>({text:e.text||"",start:e.offset||0,duration:e.duration||0})),s=t.map(e=>e.text.trim()).filter(e=>e.length>0).join(" ").replace(/\s+/g," ").trim();if(s.length>0)return console.log(`[YouTubeTranscript] Successfully extracted transcript in ${e} (${s.length} characters)`),{transcript:s,segments:t,language:e}}}catch(r){console.warn(`[YouTubeTranscript] Failed to get transcript in ${e}:`,r.message),i=r;continue}try{console.log("[YouTubeTranscript] Trying to get transcript without language specification...");let e=await s.Z.getTranscript(t);if(e&&e.length>0){let r=e.map(e=>({text:e.text||"",start:e.offset||0,duration:e.duration||0})),t=r.map(e=>e.text.trim()).filter(e=>e.length>0).join(" ").replace(/\s+/g," ").trim();if(t.length>0)return console.log(`[YouTubeTranscript] Successfully extracted transcript without language spec (${t.length} characters)`),{transcript:t,segments:r,language:"auto"}}}catch(e){console.warn("[YouTubeTranscript] Failed to get transcript without language spec:",e.message),i=e}return{transcript:"",error:function(e){if(!e)return"No transcript available for this video";let r=e.message?.toLowerCase()||"";return r.includes("transcript not available")?"No transcript available for this video":r.includes("video unavailable")?"Video is unavailable or private":r.includes("disabled")?"Subtitles have been disabled for this video":r.includes("not found")?"Video not found":r.includes("private")?"Video is private":r.includes("region")?"Video not available in this region":"No transcript available for this video"}(i)}}catch(e){return console.error("[YouTubeTranscript] Unexpected error:",e),{transcript:"",error:`Transcript extraction failed: ${e.message}`}}}async function o(e){try{console.log(`[YouTubeTranscript] Attempting fallback extraction for ${e}`);let r=await Promise.all([t.e(5074),t.e(1947)]).then(t.t.bind(t,71947,23)),s=await r.default.getInfo(`https://www.youtube.com/watch?v=${e}`),a=s.player_response?.captions?.playerCaptionsTracklistRenderer?.captionTracks;if(!a||0===a.length)return{transcript:"",error:"No captions available"};let i=a[0];if(i.baseUrl){let e=await fetch(i.baseUrl),r=await e.text(),t=function(e){try{let r=e.match(/<text[^>]*>(.*?)<\/text>/g);if(!r)return"";return r.map(e=>e.replace(/<text[^>]*>/,"").replace(/<\/text>/,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&nbsp;/g," ").trim()).filter(e=>e.length>0).join(" ").replace(/\s+/g," ").trim()}catch(e){return console.error("[YouTubeTranscript] Error parsing caption XML:",e),""}}(r);if(t&&t.length>0)return console.log(`[YouTubeTranscript] Fallback extraction successful (${t.length} characters)`),{transcript:t,language:String(i.languageCode||"unknown")}}return{transcript:"",error:"Could not extract captions from video"}}catch(e){return console.error("[YouTubeTranscript] Fallback extraction failed:",e),{transcript:"",error:`Fallback extraction failed: ${e.message}`}}}},73185:(e,r,t)=>{"use strict";t.d(r,{$p:()=>u,C$:()=>c,cc:()=>n,jx:()=>o});var s=t(61282),a=t(21764),i=t(71007);function o(e){if(!e)return null;let r=e.trim();r.includes("youtu.be/")&&(r=r.replace("youtu.be/","youtube.com/watch?v="));try{let e=new URL(r);if(e.hostname.includes("youtube.com")&&e.pathname.includes("/watch")){let r=e.searchParams.get("v");if(r)return r}if(e.hostname.includes("youtube")&&e.pathname.includes("/embed/")){let r=e.pathname.split("/");return r[r.indexOf("embed")+1]||null}if("youtu.be"===e.hostname)return e.pathname.substring(1)||null;if(e.hostname.includes("youtube")&&e.pathname.includes("/v/")){let r=e.pathname.split("/");return r[r.indexOf("v")+1]||null}}catch(e){console.error("URL parsing failed, trying regex fallback:",e)}for(let e of[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([^&\n?#]+)/,/^([a-zA-Z0-9_-]{11})$/]){let t=r.match(e);if(t&&t[1])return t[1]}return null}function n(e){return!!e&&/^[a-zA-Z0-9_-]{11}$/.test(e)}async function u(e){if(!e)return{videoId:"",title:"",thumbnailUrl:"",error:"No video ID provided"};try{let r="AIzaSyCvUahUwoVQyozpRphtVWE0ev0ha46wo0I";if(!r)return console.error("[YouTube Service] No YouTube API key configured"),{videoId:e,title:`YouTube Video (${e})`,thumbnailUrl:`https://img.youtube.com/vi/${e}/hqdefault.jpg`,error:"YouTube API key not configured - using fallback data"};let t=await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${e}&key=${r}`,{next:{revalidate:3600}});if(!t.ok){let r=await t.json();return console.error("[YouTube Service] YouTube API error:",r),{videoId:e,title:`YouTube Video (${e})`,thumbnailUrl:`https://img.youtube.com/vi/${e}/hqdefault.jpg`,error:`YouTube API error: ${r.error?.message||t.statusText}`}}let s=await t.json();if(!s.items||0===s.items.length)return console.error("[YouTube Service] Video not found:",e),{videoId:e,title:`Video Not Found (${e})`,thumbnailUrl:"",error:"Video not found"};let a=s.items[0].snippet;return{videoId:e,title:a.title,description:a.description,thumbnailUrl:a.thumbnails?.high?.url||a.thumbnails?.default?.url||"",channelTitle:a.channelTitle,publishedAt:a.publishedAt}}catch(r){return console.error("[YouTube Service] Error fetching video info:",r),{videoId:e,title:`YouTube Video (${e})`,thumbnailUrl:`https://img.youtube.com/vi/${e}/hqdefault.jpg`,error:`Error fetching video info: ${r.message}`}}}async function c(e){if(!e)return{transcript:"",error:"No video ID provided"};try{console.log(`[YouTube Service] Extracting transcript for video: ${e}`);let r=await (0,i.Bm)(e);if(r.error)return console.warn(`[YouTube Service] Transcript extraction failed: ${r.error}`),{transcript:"",error:r.error};if(!r.transcript||0===r.transcript.trim().length)return{transcript:"",error:"No transcript content available for this video"};return console.log(`[YouTube Service] Successfully extracted transcript (${r.transcript.length} characters)`),{transcript:r.transcript}}catch(e){return console.error("[YouTube Service] Error extracting transcript:",e),{transcript:"",error:`Error extracting transcript: ${e.message}`}}}(0,a.promisify)(s.exec)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[9276,5972,2749,5559],()=>t(42195));module.exports=s})();